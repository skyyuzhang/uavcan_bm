ARM GAS  /tmp/cc0y7Ept.s 			page 1


   1              		.cpu cortex-m3
   2              		.eabi_attribute 20, 1
   3              		.eabi_attribute 21, 1
   4              		.eabi_attribute 23, 3
   5              		.eabi_attribute 24, 1
   6              		.eabi_attribute 25, 1
   7              		.eabi_attribute 26, 1
   8              		.eabi_attribute 30, 1
   9              		.eabi_attribute 34, 1
  10              		.eabi_attribute 18, 4
  11              		.file	"canard_stm32.c"
  12              		.text
  13              	.Ltext0:
  14              		.cfi_sections	.debug_frame
  15              		.section	.text.isFramePriorityHigher,"ax",%progbits
  16              		.align	1
  17              		.syntax unified
  18              		.thumb
  19              		.thumb_func
  20              		.fpu softvfp
  22              	isFramePriorityHigher:
  23              	.LFB1:
  24              		.file 1 "libcanard/drivers/stm32/canard_stm32.c"
   1:libcanard/drivers/stm32/canard_stm32.c **** /*
   2:libcanard/drivers/stm32/canard_stm32.c ****  * Copyright (c) 2017 UAVCAN Team
   3:libcanard/drivers/stm32/canard_stm32.c ****  *
   4:libcanard/drivers/stm32/canard_stm32.c ****  * Distributed under the MIT License, available in the file LICENSE.
   5:libcanard/drivers/stm32/canard_stm32.c ****  *
   6:libcanard/drivers/stm32/canard_stm32.c ****  * Author: Pavel Kirienko <pavel.kirienko@zubax.com>
   7:libcanard/drivers/stm32/canard_stm32.c ****  */
   8:libcanard/drivers/stm32/canard_stm32.c **** 
   9:libcanard/drivers/stm32/canard_stm32.c **** #include "canard_stm32.h"
  10:libcanard/drivers/stm32/canard_stm32.c **** #include "_internal_bxcan.h"
  11:libcanard/drivers/stm32/canard_stm32.c **** #include <unistd.h>
  12:libcanard/drivers/stm32/canard_stm32.c **** 
  13:libcanard/drivers/stm32/canard_stm32.c **** 
  14:libcanard/drivers/stm32/canard_stm32.c **** #if CANARD_STM32_USE_CAN2
  15:libcanard/drivers/stm32/canard_stm32.c **** # define BXCAN                                                  CANARD_STM32_CAN2
  16:libcanard/drivers/stm32/canard_stm32.c **** #else
  17:libcanard/drivers/stm32/canard_stm32.c **** # define BXCAN                                                  CANARD_STM32_CAN1
  18:libcanard/drivers/stm32/canard_stm32.c **** #endif
  19:libcanard/drivers/stm32/canard_stm32.c **** 
  20:libcanard/drivers/stm32/canard_stm32.c **** /*
  21:libcanard/drivers/stm32/canard_stm32.c ****  * State variables
  22:libcanard/drivers/stm32/canard_stm32.c ****  */
  23:libcanard/drivers/stm32/canard_stm32.c **** static CanardSTM32Stats g_stats;
  24:libcanard/drivers/stm32/canard_stm32.c **** 
  25:libcanard/drivers/stm32/canard_stm32.c **** static bool g_abort_tx_on_error = false;
  26:libcanard/drivers/stm32/canard_stm32.c **** 
  27:libcanard/drivers/stm32/canard_stm32.c **** 
  28:libcanard/drivers/stm32/canard_stm32.c **** static bool isFramePriorityHigher(uint32_t a, uint32_t b)
  29:libcanard/drivers/stm32/canard_stm32.c **** {
  25              		.loc 1 29 0
  26              		.cfi_startproc
  27              		@ args = 0, pretend = 0, frame = 0
  28              		@ frame_needed = 0, uses_anonymous_args = 0
  29              		@ link register save eliminated.
ARM GAS  /tmp/cc0y7Ept.s 			page 2


  30              	.LVL0:
  31 0000 10B4     		push	{r4}
  32              	.LCFI0:
  33              		.cfi_def_cfa_offset 4
  34              		.cfi_offset 4, -4
  35 0002 0346     		mov	r3, r0
  30:libcanard/drivers/stm32/canard_stm32.c ****     const uint32_t clean_a = a & CANARD_CAN_EXT_ID_MASK;
  36              		.loc 1 30 0
  37 0004 20F06044 		bic	r4, r0, #-536870912
  38              	.LVL1:
  31:libcanard/drivers/stm32/canard_stm32.c ****     const uint32_t clean_b = b & CANARD_CAN_EXT_ID_MASK;
  39              		.loc 1 31 0
  40 0008 21F06042 		bic	r2, r1, #-536870912
  41              	.LVL2:
  32:libcanard/drivers/stm32/canard_stm32.c **** 
  33:libcanard/drivers/stm32/canard_stm32.c ****     /*
  34:libcanard/drivers/stm32/canard_stm32.c ****      * STD vs EXT - if 11 most significant bits are the same, EXT loses.
  35:libcanard/drivers/stm32/canard_stm32.c ****      */
  36:libcanard/drivers/stm32/canard_stm32.c ****     const bool ext_a = (a & CANARD_CAN_FRAME_EFF) != 0;
  37:libcanard/drivers/stm32/canard_stm32.c ****     const bool ext_b = (b & CANARD_CAN_FRAME_EFF) != 0;
  42              		.loc 1 37 0
  43 000c C80F     		lsrs	r0, r1, #31
  44              	.LVL3:
  38:libcanard/drivers/stm32/canard_stm32.c ****     if (ext_a != ext_b)
  45              		.loc 1 38 0
  46 000e B0EBD37F 		cmp	r0, r3, lsr #31
  47 0012 0FD0     		beq	.L2
  48              	.LBB2:
  39:libcanard/drivers/stm32/canard_stm32.c ****     {
  40:libcanard/drivers/stm32/canard_stm32.c ****         const uint32_t arb11_a = ext_a ? (clean_a >> 18U) : clean_a;
  49              		.loc 1 40 0
  50 0014 002B     		cmp	r3, #0
  51 0016 09DB     		blt	.L8
  52              	.LVL4:
  53              	.L3:
  41:libcanard/drivers/stm32/canard_stm32.c ****         const uint32_t arb11_b = ext_b ? (clean_b >> 18U) : clean_b;
  54              		.loc 1 41 0 discriminator 4
  55 0018 0029     		cmp	r1, #0
  56 001a 09DB     		blt	.L9
  57              	.LVL5:
  58              	.L4:
  42:libcanard/drivers/stm32/canard_stm32.c ****         if (arb11_a != arb11_b)
  59              		.loc 1 42 0 discriminator 4
  60 001c 9442     		cmp	r4, r2
  61 001e 03D0     		beq	.L5
  43:libcanard/drivers/stm32/canard_stm32.c ****         {
  44:libcanard/drivers/stm32/canard_stm32.c ****             return arb11_a < arb11_b;
  62              		.loc 1 44 0
  63 0020 9442     		cmp	r4, r2
  64 0022 2CBF     		ite	cs
  65 0024 0020     		movcs	r0, #0
  66              	.LVL6:
  67 0026 0120     		movcc	r0, #1
  68              	.LVL7:
  69              	.L5:
  70              	.LBE2:
  45:libcanard/drivers/stm32/canard_stm32.c ****         }
ARM GAS  /tmp/cc0y7Ept.s 			page 3


  46:libcanard/drivers/stm32/canard_stm32.c ****         else
  47:libcanard/drivers/stm32/canard_stm32.c ****         {
  48:libcanard/drivers/stm32/canard_stm32.c ****             return ext_b;
  49:libcanard/drivers/stm32/canard_stm32.c ****         }
  50:libcanard/drivers/stm32/canard_stm32.c ****     }
  51:libcanard/drivers/stm32/canard_stm32.c **** 
  52:libcanard/drivers/stm32/canard_stm32.c ****     /*
  53:libcanard/drivers/stm32/canard_stm32.c ****      * RTR vs Data frame - if frame identifiers and frame types are the same, RTR loses.
  54:libcanard/drivers/stm32/canard_stm32.c ****      */
  55:libcanard/drivers/stm32/canard_stm32.c ****     const bool rtr_a = (a & CANARD_CAN_FRAME_RTR) != 0;
  56:libcanard/drivers/stm32/canard_stm32.c ****     const bool rtr_b = (b & CANARD_CAN_FRAME_RTR) != 0;
  57:libcanard/drivers/stm32/canard_stm32.c ****     if ((clean_a == clean_b) && (rtr_a != rtr_b))
  58:libcanard/drivers/stm32/canard_stm32.c ****     {
  59:libcanard/drivers/stm32/canard_stm32.c ****         return rtr_b;
  60:libcanard/drivers/stm32/canard_stm32.c ****     }
  61:libcanard/drivers/stm32/canard_stm32.c **** 
  62:libcanard/drivers/stm32/canard_stm32.c ****     /*
  63:libcanard/drivers/stm32/canard_stm32.c ****      * Plain ID arbitration - greater value loses.
  64:libcanard/drivers/stm32/canard_stm32.c ****      */
  65:libcanard/drivers/stm32/canard_stm32.c ****     return clean_a < clean_b;
  66:libcanard/drivers/stm32/canard_stm32.c **** }
  71              		.loc 1 66 0
  72 0028 10BC     		pop	{r4}
  73              	.LCFI1:
  74              		.cfi_remember_state
  75              		.cfi_restore 4
  76              		.cfi_def_cfa_offset 0
  77 002a 7047     		bx	lr
  78              	.LVL8:
  79              	.L8:
  80              	.LCFI2:
  81              		.cfi_restore_state
  82              	.LBB3:
  40:libcanard/drivers/stm32/canard_stm32.c ****         const uint32_t arb11_b = ext_b ? (clean_b >> 18U) : clean_b;
  83              		.loc 1 40 0 discriminator 1
  84 002c A40C     		lsrs	r4, r4, #18
  85              	.LVL9:
  86 002e F3E7     		b	.L3
  87              	.LVL10:
  88              	.L9:
  41:libcanard/drivers/stm32/canard_stm32.c ****         if (arb11_a != arb11_b)
  89              		.loc 1 41 0 discriminator 1
  90 0030 920C     		lsrs	r2, r2, #18
  91              	.LVL11:
  92 0032 F3E7     		b	.L4
  93              	.LVL12:
  94              	.L2:
  95              	.LBE3:
  55:libcanard/drivers/stm32/canard_stm32.c ****     const bool rtr_b = (b & CANARD_CAN_FRAME_RTR) != 0;
  96              		.loc 1 55 0
  97 0034 C3F38073 		ubfx	r3, r3, #30, #1
  98              	.LVL13:
  56:libcanard/drivers/stm32/canard_stm32.c ****     if ((clean_a == clean_b) && (rtr_a != rtr_b))
  99              		.loc 1 56 0
 100 0038 C1F38070 		ubfx	r0, r1, #30, #1
 101              	.LVL14:
  57:libcanard/drivers/stm32/canard_stm32.c ****     {
ARM GAS  /tmp/cc0y7Ept.s 			page 4


 102              		.loc 1 57 0
 103 003c 9442     		cmp	r4, r2
 104 003e 04D0     		beq	.L10
 105              	.L6:
  65:libcanard/drivers/stm32/canard_stm32.c **** }
 106              		.loc 1 65 0
 107 0040 9442     		cmp	r4, r2
 108 0042 2CBF     		ite	cs
 109 0044 0020     		movcs	r0, #0
 110              	.LVL15:
 111 0046 0120     		movcc	r0, #1
 112 0048 EEE7     		b	.L5
 113              	.LVL16:
 114              	.L10:
  57:libcanard/drivers/stm32/canard_stm32.c ****     {
 115              		.loc 1 57 0 discriminator 1
 116 004a 8342     		cmp	r3, r0
 117 004c ECD1     		bne	.L5
 118 004e F7E7     		b	.L6
 119              		.cfi_endproc
 120              	.LFE1:
 122              		.section	.text.convertFrameIDCanardToRegister,"ax",%progbits
 123              		.align	1
 124              		.syntax unified
 125              		.thumb
 126              		.thumb_func
 127              		.fpu softvfp
 129              	convertFrameIDCanardToRegister:
 130              	.LFB2:
  67:libcanard/drivers/stm32/canard_stm32.c **** 
  68:libcanard/drivers/stm32/canard_stm32.c **** /// Converts libcanard ID value into the bxCAN TX ID register format.
  69:libcanard/drivers/stm32/canard_stm32.c **** static uint32_t convertFrameIDCanardToRegister(const uint32_t id)
  70:libcanard/drivers/stm32/canard_stm32.c **** {
 131              		.loc 1 70 0
 132              		.cfi_startproc
 133              		@ args = 0, pretend = 0, frame = 0
 134              		@ frame_needed = 0, uses_anonymous_args = 0
 135              		@ link register save eliminated.
 136              	.LVL17:
  71:libcanard/drivers/stm32/canard_stm32.c ****     uint32_t out = 0;
  72:libcanard/drivers/stm32/canard_stm32.c **** 
  73:libcanard/drivers/stm32/canard_stm32.c ****     if (id & CANARD_CAN_FRAME_EFF)
 137              		.loc 1 73 0
 138 0000 021E     		subs	r2, r0, #0
 139 0002 06DB     		blt	.L15
  74:libcanard/drivers/stm32/canard_stm32.c ****     {
  75:libcanard/drivers/stm32/canard_stm32.c ****         out = ((id & CANARD_CAN_EXT_ID_MASK) << 3U) | CANARD_STM32_CAN_TIR_IDE;
  76:libcanard/drivers/stm32/canard_stm32.c ****     }
  77:libcanard/drivers/stm32/canard_stm32.c ****     else
  78:libcanard/drivers/stm32/canard_stm32.c ****     {
  79:libcanard/drivers/stm32/canard_stm32.c ****         out = ((id & CANARD_CAN_STD_ID_MASK) << 21U);
 140              		.loc 1 79 0
 141 0004 5005     		lsls	r0, r2, #21
 142              	.LVL18:
 143              	.L13:
  80:libcanard/drivers/stm32/canard_stm32.c ****     }
  81:libcanard/drivers/stm32/canard_stm32.c **** 
ARM GAS  /tmp/cc0y7Ept.s 			page 5


  82:libcanard/drivers/stm32/canard_stm32.c ****     if (id & CANARD_CAN_FRAME_RTR)
 144              		.loc 1 82 0
 145 0006 12F0804F 		tst	r2, #1073741824
 146 000a 01D0     		beq	.L11
  83:libcanard/drivers/stm32/canard_stm32.c ****     {
  84:libcanard/drivers/stm32/canard_stm32.c ****         out |= CANARD_STM32_CAN_TIR_RTR;
 147              		.loc 1 84 0
 148 000c 40F00200 		orr	r0, r0, #2
 149              	.LVL19:
 150              	.L11:
  85:libcanard/drivers/stm32/canard_stm32.c ****     }
  86:libcanard/drivers/stm32/canard_stm32.c **** 
  87:libcanard/drivers/stm32/canard_stm32.c ****     return out;
  88:libcanard/drivers/stm32/canard_stm32.c **** }
 151              		.loc 1 88 0
 152 0010 7047     		bx	lr
 153              	.LVL20:
 154              	.L15:
  75:libcanard/drivers/stm32/canard_stm32.c ****     }
 155              		.loc 1 75 0
 156 0012 D300     		lsls	r3, r2, #3
 157 0014 43F00400 		orr	r0, r3, #4
 158              	.LVL21:
 159 0018 F5E7     		b	.L13
 160              		.cfi_endproc
 161              	.LFE2:
 163              		.section	.text.convertFrameIDRegisterToCanard,"ax",%progbits
 164              		.align	1
 165              		.syntax unified
 166              		.thumb
 167              		.thumb_func
 168              		.fpu softvfp
 170              	convertFrameIDRegisterToCanard:
 171              	.LFB3:
  89:libcanard/drivers/stm32/canard_stm32.c **** 
  90:libcanard/drivers/stm32/canard_stm32.c **** /// Converts bxCAN TX/RX (sic! both RX/TX are supported) ID register value into the libcanard ID fo
  91:libcanard/drivers/stm32/canard_stm32.c **** static uint32_t convertFrameIDRegisterToCanard(const uint32_t id)
  92:libcanard/drivers/stm32/canard_stm32.c **** {
 172              		.loc 1 92 0
 173              		.cfi_startproc
 174              		@ args = 0, pretend = 0, frame = 0
 175              		@ frame_needed = 0, uses_anonymous_args = 0
 176              		@ link register save eliminated.
 177              	.LVL22:
  93:libcanard/drivers/stm32/canard_stm32.c **** #if (CANARD_STM32_CAN_TIR_RTR != CANARD_STM32_CAN_RIR_RTR) ||\
  94:libcanard/drivers/stm32/canard_stm32.c ****     (CANARD_STM32_CAN_TIR_IDE != CANARD_STM32_CAN_RIR_IDE)
  95:libcanard/drivers/stm32/canard_stm32.c **** # error "RIR bits do not match TIR bits, TIR --> libcanard conversion is not possible"
  96:libcanard/drivers/stm32/canard_stm32.c **** #endif
  97:libcanard/drivers/stm32/canard_stm32.c **** 
  98:libcanard/drivers/stm32/canard_stm32.c ****     uint32_t out = 0;
  99:libcanard/drivers/stm32/canard_stm32.c **** 
 100:libcanard/drivers/stm32/canard_stm32.c ****     if ((id & CANARD_STM32_CAN_RIR_IDE) == 0)
 178              		.loc 1 100 0
 179 0000 10F0040F 		tst	r0, #4
 180 0004 07D1     		bne	.L17
 101:libcanard/drivers/stm32/canard_stm32.c ****     {
 102:libcanard/drivers/stm32/canard_stm32.c ****         out = (CANARD_CAN_STD_ID_MASK & (id >> 21U));
ARM GAS  /tmp/cc0y7Ept.s 			page 6


 181              		.loc 1 102 0
 182 0006 430D     		lsrs	r3, r0, #21
 183              	.LVL23:
 184              	.L18:
 103:libcanard/drivers/stm32/canard_stm32.c ****     }
 104:libcanard/drivers/stm32/canard_stm32.c ****     else
 105:libcanard/drivers/stm32/canard_stm32.c ****     {
 106:libcanard/drivers/stm32/canard_stm32.c ****         out = (CANARD_CAN_EXT_ID_MASK & (id >> 3U)) | CANARD_CAN_FRAME_EFF;
 107:libcanard/drivers/stm32/canard_stm32.c ****     }
 108:libcanard/drivers/stm32/canard_stm32.c **** 
 109:libcanard/drivers/stm32/canard_stm32.c ****     if ((id & CANARD_STM32_CAN_RIR_RTR) != 0)
 185              		.loc 1 109 0
 186 0008 10F0020F 		tst	r0, #2
 187 000c 01D0     		beq	.L16
 110:libcanard/drivers/stm32/canard_stm32.c ****     {
 111:libcanard/drivers/stm32/canard_stm32.c ****         out |= CANARD_CAN_FRAME_RTR;
 188              		.loc 1 111 0
 189 000e 43F08043 		orr	r3, r3, #1073741824
 190              	.LVL24:
 191              	.L16:
 112:libcanard/drivers/stm32/canard_stm32.c ****     }
 113:libcanard/drivers/stm32/canard_stm32.c **** 
 114:libcanard/drivers/stm32/canard_stm32.c ****     return out;
 115:libcanard/drivers/stm32/canard_stm32.c **** }
 192              		.loc 1 115 0
 193 0012 1846     		mov	r0, r3
 194              	.LVL25:
 195 0014 7047     		bx	lr
 196              	.LVL26:
 197              	.L17:
 106:libcanard/drivers/stm32/canard_stm32.c ****     }
 198              		.loc 1 106 0
 199 0016 C308     		lsrs	r3, r0, #3
 200 0018 43F00043 		orr	r3, r3, #-2147483648
 201              	.LVL27:
 202 001c F4E7     		b	.L18
 203              		.cfi_endproc
 204              	.LFE3:
 206              		.section	.text.waitMSRINAKBitStateChange,"ax",%progbits
 207              		.align	1
 208              		.syntax unified
 209              		.thumb
 210              		.thumb_func
 211              		.fpu softvfp
 213              	waitMSRINAKBitStateChange:
 214              	.LFB4:
 116:libcanard/drivers/stm32/canard_stm32.c **** 
 117:libcanard/drivers/stm32/canard_stm32.c **** 
 118:libcanard/drivers/stm32/canard_stm32.c **** static bool waitMSRINAKBitStateChange(volatile const CanardSTM32CANType* const bxcan, const bool ta
 119:libcanard/drivers/stm32/canard_stm32.c **** {
 215              		.loc 1 119 0
 216              		.cfi_startproc
 217              		@ args = 0, pretend = 0, frame = 0
 218              		@ frame_needed = 0, uses_anonymous_args = 0
 219              		@ link register save eliminated.
 220              	.LVL28:
 221              	.LBB4:
ARM GAS  /tmp/cc0y7Ept.s 			page 7


 120:libcanard/drivers/stm32/canard_stm32.c ****     /**
 121:libcanard/drivers/stm32/canard_stm32.c ****      * A properly functioning bus will exhibit 11 consecutive recessive bits at the end of every co
 122:libcanard/drivers/stm32/canard_stm32.c ****      * or while the bus is idle. The 11 consecutive recessive bits are made up of:
 123:libcanard/drivers/stm32/canard_stm32.c ****      *  1 bit - acknowledgement delimiter
 124:libcanard/drivers/stm32/canard_stm32.c ****      *  7 bit - end of frame bits
 125:libcanard/drivers/stm32/canard_stm32.c ****      *  3 bit - inter frame space
 126:libcanard/drivers/stm32/canard_stm32.c ****      * This adds up to 11; therefore, it is not really necessary to wait longer than a few frame TX
 127:libcanard/drivers/stm32/canard_stm32.c ****      */
 128:libcanard/drivers/stm32/canard_stm32.c ****     static const uint16_t TimeoutMilliseconds = 1000;
 129:libcanard/drivers/stm32/canard_stm32.c **** 
 130:libcanard/drivers/stm32/canard_stm32.c ****     for (uint16_t wait_ack = 0; wait_ack < TimeoutMilliseconds; wait_ack++)
 222              		.loc 1 130 0
 223 0000 0022     		movs	r2, #0
 224              	.LVL29:
 225              	.L21:
 226              		.loc 1 130 0 is_stmt 0 discriminator 1
 227 0002 B2F57A7F 		cmp	r2, #1000
 228 0006 08D2     		bcs	.L25
 229              	.LBB5:
 131:libcanard/drivers/stm32/canard_stm32.c ****     {
 132:libcanard/drivers/stm32/canard_stm32.c ****         const bool state = (bxcan->MSR & CANARD_STM32_CAN_MSR_INAK) != 0;
 230              		.loc 1 132 0 is_stmt 1
 231 0008 4368     		ldr	r3, [r0, #4]
 232 000a 03F00103 		and	r3, r3, #1
 233 000e DBB2     		uxtb	r3, r3
 234              	.LVL30:
 133:libcanard/drivers/stm32/canard_stm32.c ****         if (state == target_state)
 235              		.loc 1 133 0
 236 0010 8B42     		cmp	r3, r1
 237 0012 04D0     		beq	.L24
 238              	.LBE5:
 130:libcanard/drivers/stm32/canard_stm32.c ****     {
 239              		.loc 1 130 0 discriminator 2
 240 0014 0132     		adds	r2, r2, #1
 241              	.LVL31:
 242 0016 92B2     		uxth	r2, r2
 243              	.LVL32:
 244 0018 F3E7     		b	.L21
 245              	.LVL33:
 246              	.L25:
 247              	.LBE4:
 134:libcanard/drivers/stm32/canard_stm32.c ****         {
 135:libcanard/drivers/stm32/canard_stm32.c ****             return true;
 136:libcanard/drivers/stm32/canard_stm32.c ****         }
 137:libcanard/drivers/stm32/canard_stm32.c **** 
 138:libcanard/drivers/stm32/canard_stm32.c ****         // Sleep 1 millisecond
 139:libcanard/drivers/stm32/canard_stm32.c ****         //usleep(1000);           // TODO: This function may be missing on some platforms
 140:libcanard/drivers/stm32/canard_stm32.c ****     }
 141:libcanard/drivers/stm32/canard_stm32.c **** 
 142:libcanard/drivers/stm32/canard_stm32.c ****     return false;
 248              		.loc 1 142 0
 249 001a 0020     		movs	r0, #0
 250              	.LVL34:
 251              	.LBB7:
 252 001c 7047     		bx	lr
 253              	.LVL35:
 254              	.L24:
ARM GAS  /tmp/cc0y7Ept.s 			page 8


 255              	.LBB6:
 135:libcanard/drivers/stm32/canard_stm32.c ****         }
 256              		.loc 1 135 0
 257 001e 0120     		movs	r0, #1
 258              	.LVL36:
 259              	.LBE6:
 260              	.LBE7:
 143:libcanard/drivers/stm32/canard_stm32.c **** }
 261              		.loc 1 143 0
 262 0020 7047     		bx	lr
 263              		.cfi_endproc
 264              	.LFE4:
 266              		.section	.text.processErrorStatus,"ax",%progbits
 267              		.align	1
 268              		.syntax unified
 269              		.thumb
 270              		.thumb_func
 271              		.fpu softvfp
 273              	processErrorStatus:
 274              	.LFB5:
 144:libcanard/drivers/stm32/canard_stm32.c **** 
 145:libcanard/drivers/stm32/canard_stm32.c **** 
 146:libcanard/drivers/stm32/canard_stm32.c **** static void processErrorStatus(void)
 147:libcanard/drivers/stm32/canard_stm32.c **** {
 275              		.loc 1 147 0
 276              		.cfi_startproc
 277              		@ args = 0, pretend = 0, frame = 0
 278              		@ frame_needed = 0, uses_anonymous_args = 0
 279              		@ link register save eliminated.
 148:libcanard/drivers/stm32/canard_stm32.c ****     /*
 149:libcanard/drivers/stm32/canard_stm32.c ****      * Aborting TX transmissions if abort on error was requested
 150:libcanard/drivers/stm32/canard_stm32.c ****      * Updating error counter
 151:libcanard/drivers/stm32/canard_stm32.c ****      */
 152:libcanard/drivers/stm32/canard_stm32.c ****     const uint8_t lec = (uint8_t)((BXCAN->ESR & CANARD_STM32_CAN_ESR_LEC_MASK) >> CANARD_STM32_CAN_
 280              		.loc 1 152 0
 281 0000 104B     		ldr	r3, .L33
 282 0002 9B69     		ldr	r3, [r3, #24]
 283              	.LVL37:
 153:libcanard/drivers/stm32/canard_stm32.c **** 
 154:libcanard/drivers/stm32/canard_stm32.c ****     if (lec != 0)
 284              		.loc 1 154 0
 285 0004 13F0700F 		tst	r3, #112
 286 0008 1BD0     		beq	.L30
 147:libcanard/drivers/stm32/canard_stm32.c ****     /*
 287              		.loc 1 147 0
 288 000a 4DF804BD 		push	{fp}
 289              	.LCFI3:
 290              		.cfi_def_cfa_offset 4
 291              		.cfi_offset 11, -4
 155:libcanard/drivers/stm32/canard_stm32.c ****     {
 156:libcanard/drivers/stm32/canard_stm32.c ****         BXCAN->ESR = 0;                 // This action does only affect the LEC bits, other bits ar
 292              		.loc 1 156 0
 293 000e 0D4B     		ldr	r3, .L33
 294              	.LVL38:
 295 0010 0022     		movs	r2, #0
 296 0012 9A61     		str	r2, [r3, #24]
 157:libcanard/drivers/stm32/canard_stm32.c ****         g_stats.error_count++;
ARM GAS  /tmp/cc0y7Ept.s 			page 9


 297              		.loc 1 157 0
 298 0014 0C49     		ldr	r1, .L33+4
 299 0016 D1E902BC 		ldrd	fp, [r1, #8]
 300 001a 1BF10102 		adds	r2, fp, #1
 301 001e 4CF10003 		adc	r3, ip, #0
 302 0022 C1E90223 		strd	r2, [r1, #8]
 158:libcanard/drivers/stm32/canard_stm32.c **** 
 159:libcanard/drivers/stm32/canard_stm32.c ****         // Abort pending transmissions if auto abort on error is enabled, or if we're in bus off mo
 160:libcanard/drivers/stm32/canard_stm32.c ****         if (g_abort_tx_on_error || (BXCAN->ESR & CANARD_STM32_CAN_ESR_BOFF))
 303              		.loc 1 160 0
 304 0026 094B     		ldr	r3, .L33+8
 305 0028 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 306 002a 23B9     		cbnz	r3, .L28
 307              		.loc 1 160 0 is_stmt 0 discriminator 1
 308 002c 054B     		ldr	r3, .L33
 309 002e 9B69     		ldr	r3, [r3, #24]
 310 0030 13F0040F 		tst	r3, #4
 311 0034 02D0     		beq	.L26
 312              	.L28:
 161:libcanard/drivers/stm32/canard_stm32.c ****         {
 162:libcanard/drivers/stm32/canard_stm32.c ****             BXCAN->TSR = CANARD_STM32_CAN_TSR_ABRQ0 | CANARD_STM32_CAN_TSR_ABRQ1 | CANARD_STM32_CAN
 313              		.loc 1 162 0 is_stmt 1
 314 0036 034B     		ldr	r3, .L33
 315 0038 054A     		ldr	r2, .L33+12
 316 003a 9A60     		str	r2, [r3, #8]
 317              	.L26:
 163:libcanard/drivers/stm32/canard_stm32.c ****         }
 164:libcanard/drivers/stm32/canard_stm32.c ****     }
 165:libcanard/drivers/stm32/canard_stm32.c **** }
 318              		.loc 1 165 0
 319 003c 5DF804BB 		ldr	fp, [sp], #4
 320              	.LCFI4:
 321              		.cfi_restore 11
 322              		.cfi_def_cfa_offset 0
 323 0040 7047     		bx	lr
 324              	.LVL39:
 325              	.L30:
 326 0042 7047     		bx	lr
 327              	.L34:
 328              		.align	2
 329              	.L33:
 330 0044 00640040 		.word	1073767424
 331 0048 00000000 		.word	.LANCHOR0
 332 004c 00000000 		.word	.LANCHOR1
 333 0050 80808000 		.word	8421504
 334              		.cfi_endproc
 335              	.LFE5:
 337              		.section	.text.canardSTM32Init,"ax",%progbits
 338              		.align	1
 339              		.global	canardSTM32Init
 340              		.syntax unified
 341              		.thumb
 342              		.thumb_func
 343              		.fpu softvfp
 345              	canardSTM32Init:
 346              	.LFB6:
 166:libcanard/drivers/stm32/canard_stm32.c **** 
ARM GAS  /tmp/cc0y7Ept.s 			page 10


 167:libcanard/drivers/stm32/canard_stm32.c **** 
 168:libcanard/drivers/stm32/canard_stm32.c **** int16_t canardSTM32Init(const CanardSTM32CANTimings* const timings,
 169:libcanard/drivers/stm32/canard_stm32.c ****                         const CanardSTM32IfaceMode iface_mode)
 170:libcanard/drivers/stm32/canard_stm32.c **** {
 347              		.loc 1 170 0
 348              		.cfi_startproc
 349              		@ args = 0, pretend = 0, frame = 0
 350              		@ frame_needed = 0, uses_anonymous_args = 0
 351              	.LVL40:
 171:libcanard/drivers/stm32/canard_stm32.c ****     /*
 172:libcanard/drivers/stm32/canard_stm32.c ****      * Paranoia time.
 173:libcanard/drivers/stm32/canard_stm32.c ****      */
 174:libcanard/drivers/stm32/canard_stm32.c ****     if ((iface_mode != CanardSTM32IfaceModeNormal) &&
 352              		.loc 1 174 0
 353 0000 0229     		cmp	r1, #2
 354 0002 00F2B380 		bhi	.L42
 175:libcanard/drivers/stm32/canard_stm32.c ****         (iface_mode != CanardSTM32IfaceModeSilent) &&
 176:libcanard/drivers/stm32/canard_stm32.c ****         (iface_mode != CanardSTM32IfaceModeAutomaticTxAbortOnError))
 177:libcanard/drivers/stm32/canard_stm32.c ****     {
 178:libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_ERROR_INVALID_ARGUMENT;
 179:libcanard/drivers/stm32/canard_stm32.c ****     }
 180:libcanard/drivers/stm32/canard_stm32.c **** 
 181:libcanard/drivers/stm32/canard_stm32.c ****     if ((timings == NULL) ||
 355              		.loc 1 181 0
 356 0006 0028     		cmp	r0, #0
 357 0008 00F0B380 		beq	.L43
 170:libcanard/drivers/stm32/canard_stm32.c ****     /*
 358              		.loc 1 170 0 discriminator 1
 359 000c 38B5     		push	{r3, r4, r5, lr}
 360              	.LCFI5:
 361              		.cfi_def_cfa_offset 16
 362              		.cfi_offset 3, -16
 363              		.cfi_offset 4, -12
 364              		.cfi_offset 5, -8
 365              		.cfi_offset 14, -4
 182:libcanard/drivers/stm32/canard_stm32.c ****         (timings->bit_rate_prescaler < 1) || (timings->bit_rate_prescaler > 1024) ||
 366              		.loc 1 182 0 discriminator 1
 367 000e 0388     		ldrh	r3, [r0]
 181:libcanard/drivers/stm32/canard_stm32.c ****         (timings->bit_rate_prescaler < 1) || (timings->bit_rate_prescaler > 1024) ||
 368              		.loc 1 181 0 discriminator 1
 369 0010 002B     		cmp	r3, #0
 370 0012 00F0B180 		beq	.L44
 371              		.loc 1 182 0
 372 0016 B3F5806F 		cmp	r3, #1024
 373 001a 00F2B080 		bhi	.L45
 183:libcanard/drivers/stm32/canard_stm32.c ****         (timings->max_resynchronization_jump_width < 1) || (timings->max_resynchronization_jump_wid
 374              		.loc 1 183 0 discriminator 1
 375 001e 0379     		ldrb	r3, [r0, #4]	@ zero_extendqisi2
 182:libcanard/drivers/stm32/canard_stm32.c ****         (timings->bit_rate_prescaler < 1) || (timings->bit_rate_prescaler > 1024) ||
 376              		.loc 1 182 0 discriminator 1
 377 0020 002B     		cmp	r3, #0
 378 0022 00F0AF80 		beq	.L46
 379              		.loc 1 183 0
 380 0026 042B     		cmp	r3, #4
 381 0028 00F2AF80 		bhi	.L47
 184:libcanard/drivers/stm32/canard_stm32.c ****         (timings->bit_segment_1 < 1) || (timings->bit_segment_1 > 16) ||
 382              		.loc 1 184 0 discriminator 1
ARM GAS  /tmp/cc0y7Ept.s 			page 11


 383 002c 8378     		ldrb	r3, [r0, #2]	@ zero_extendqisi2
 183:libcanard/drivers/stm32/canard_stm32.c ****         (timings->max_resynchronization_jump_width < 1) || (timings->max_resynchronization_jump_wid
 384              		.loc 1 183 0 discriminator 1
 385 002e 002B     		cmp	r3, #0
 386 0030 00F0AE80 		beq	.L48
 387              		.loc 1 184 0
 388 0034 102B     		cmp	r3, #16
 389 0036 00F2AE80 		bhi	.L49
 185:libcanard/drivers/stm32/canard_stm32.c ****         (timings->bit_segment_2 < 1) || (timings->bit_segment_2 > 8))
 390              		.loc 1 185 0 discriminator 1
 391 003a C378     		ldrb	r3, [r0, #3]	@ zero_extendqisi2
 184:libcanard/drivers/stm32/canard_stm32.c ****         (timings->bit_segment_1 < 1) || (timings->bit_segment_1 > 16) ||
 392              		.loc 1 184 0 discriminator 1
 393 003c 002B     		cmp	r3, #0
 394 003e 00F0AD80 		beq	.L50
 395              		.loc 1 185 0
 396 0042 082B     		cmp	r3, #8
 397 0044 00F2AD80 		bhi	.L51
 398 0048 0C46     		mov	r4, r1
 399 004a 0546     		mov	r5, r0
 186:libcanard/drivers/stm32/canard_stm32.c ****     {
 187:libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_ERROR_INVALID_ARGUMENT;
 188:libcanard/drivers/stm32/canard_stm32.c ****     }
 189:libcanard/drivers/stm32/canard_stm32.c **** 
 190:libcanard/drivers/stm32/canard_stm32.c ****     /*
 191:libcanard/drivers/stm32/canard_stm32.c ****      * Initial setup
 192:libcanard/drivers/stm32/canard_stm32.c ****      */
 193:libcanard/drivers/stm32/canard_stm32.c ****     memset(&g_stats, 0, sizeof(g_stats));
 400              		.loc 1 193 0
 401 004c 564A     		ldr	r2, .L62
 402 004e 0023     		movs	r3, #0
 403 0050 1360     		str	r3, [r2]
 404 0052 5360     		str	r3, [r2, #4]
 405 0054 9360     		str	r3, [r2, #8]
 406 0056 D360     		str	r3, [r2, #12]
 194:libcanard/drivers/stm32/canard_stm32.c **** 
 195:libcanard/drivers/stm32/canard_stm32.c ****     g_abort_tx_on_error = (iface_mode == CanardSTM32IfaceModeAutomaticTxAbortOnError);
 407              		.loc 1 195 0
 408 0058 0229     		cmp	r1, #2
 409 005a 14BF     		ite	ne
 410 005c 0021     		movne	r1, #0
 411              	.LVL41:
 412 005e 0121     		moveq	r1, #1
 413 0060 524A     		ldr	r2, .L62+4
 414 0062 1170     		strb	r1, [r2]
 196:libcanard/drivers/stm32/canard_stm32.c **** 
 197:libcanard/drivers/stm32/canard_stm32.c **** #if CANARD_STM32_USE_CAN2
 198:libcanard/drivers/stm32/canard_stm32.c ****     // If we're using CAN2, we MUST initialize CAN1 first, because CAN2 is a slave to CAN1.
 199:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->IER = 0;                                 // We need no interrupts
 200:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->MCR &= ~CANARD_STM32_CAN_MCR_SLEEP;      // Exit sleep mode
 201:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->MCR |= CANARD_STM32_CAN_MCR_INRQ;        // Request init
 202:libcanard/drivers/stm32/canard_stm32.c **** 
 203:libcanard/drivers/stm32/canard_stm32.c ****     if (!waitMSRINAKBitStateChange(CANARD_STM32_CAN1, true))    // Wait for synchronization
 204:libcanard/drivers/stm32/canard_stm32.c ****     {
 205:libcanard/drivers/stm32/canard_stm32.c ****         CANARD_STM32_CAN1->MCR = CANARD_STM32_CAN_MCR_RESET;
 206:libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_STM32_ERROR_MSR_INAK_NOT_SET;
 207:libcanard/drivers/stm32/canard_stm32.c ****     }
ARM GAS  /tmp/cc0y7Ept.s 			page 12


 208:libcanard/drivers/stm32/canard_stm32.c ****     // CAN1 will be left in the initialization mode forever, in this mode it does not affect the bu
 209:libcanard/drivers/stm32/canard_stm32.c **** #endif
 210:libcanard/drivers/stm32/canard_stm32.c **** 
 211:libcanard/drivers/stm32/canard_stm32.c ****     BXCAN->IER = 0;                                             // We need no interrupts
 415              		.loc 1 211 0
 416 0064 5248     		ldr	r0, .L62+8
 417              	.LVL42:
 418 0066 4361     		str	r3, [r0, #20]
 212:libcanard/drivers/stm32/canard_stm32.c ****     BXCAN->MCR &= ~CANARD_STM32_CAN_MCR_SLEEP;                  // Exit sleep mode
 419              		.loc 1 212 0
 420 0068 0368     		ldr	r3, [r0]
 421 006a 23F00203 		bic	r3, r3, #2
 422 006e 0360     		str	r3, [r0]
 213:libcanard/drivers/stm32/canard_stm32.c ****     BXCAN->MCR |= CANARD_STM32_CAN_MCR_INRQ;                    // Request init
 423              		.loc 1 213 0
 424 0070 0368     		ldr	r3, [r0]
 425 0072 43F00103 		orr	r3, r3, #1
 426 0076 0360     		str	r3, [r0]
 214:libcanard/drivers/stm32/canard_stm32.c **** 
 215:libcanard/drivers/stm32/canard_stm32.c ****     if (!waitMSRINAKBitStateChange(BXCAN, true))                // Wait for synchronization
 427              		.loc 1 215 0
 428 0078 0121     		movs	r1, #1
 429 007a FFF7FEFF 		bl	waitMSRINAKBitStateChange
 430              	.LVL43:
 431 007e 0028     		cmp	r0, #0
 432 0080 57D0     		beq	.L57
 216:libcanard/drivers/stm32/canard_stm32.c ****     {
 217:libcanard/drivers/stm32/canard_stm32.c ****         BXCAN->MCR = CANARD_STM32_CAN_MCR_RESET;
 218:libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_STM32_ERROR_MSR_INAK_NOT_SET;
 219:libcanard/drivers/stm32/canard_stm32.c ****     }
 220:libcanard/drivers/stm32/canard_stm32.c **** 
 221:libcanard/drivers/stm32/canard_stm32.c ****     /*
 222:libcanard/drivers/stm32/canard_stm32.c ****      * Hardware initialization (the hardware has already confirmed initialization mode, see above)
 223:libcanard/drivers/stm32/canard_stm32.c ****      */
 224:libcanard/drivers/stm32/canard_stm32.c ****     BXCAN->MCR = CANARD_STM32_CAN_MCR_ABOM | CANARD_STM32_CAN_MCR_AWUM | CANARD_STM32_CAN_MCR_INRQ;
 433              		.loc 1 224 0
 434 0082 4B4B     		ldr	r3, .L62+8
 435 0084 6122     		movs	r2, #97
 436 0086 1A60     		str	r2, [r3]
 225:libcanard/drivers/stm32/canard_stm32.c **** 
 226:libcanard/drivers/stm32/canard_stm32.c ****     BXCAN->BTR = (((timings->max_resynchronization_jump_width - 1U) &    3U) << 24U) |
 437              		.loc 1 226 0
 438 0088 2B79     		ldrb	r3, [r5, #4]	@ zero_extendqisi2
 439 008a 013B     		subs	r3, r3, #1
 440 008c 1B06     		lsls	r3, r3, #24
 441 008e 03F04073 		and	r3, r3, #50331648
 227:libcanard/drivers/stm32/canard_stm32.c ****                  (((timings->bit_segment_1 - 1U)                    &   15U) << 16U) |
 442              		.loc 1 227 0
 443 0092 AA78     		ldrb	r2, [r5, #2]	@ zero_extendqisi2
 444 0094 013A     		subs	r2, r2, #1
 445 0096 1204     		lsls	r2, r2, #16
 446 0098 02F47022 		and	r2, r2, #983040
 226:libcanard/drivers/stm32/canard_stm32.c ****                  (((timings->bit_segment_1 - 1U)                    &   15U) << 16U) |
 447              		.loc 1 226 0
 448 009c 1343     		orrs	r3, r3, r2
 228:libcanard/drivers/stm32/canard_stm32.c ****                  (((timings->bit_segment_2 - 1U)                    &    7U) << 20U) |
 449              		.loc 1 228 0
ARM GAS  /tmp/cc0y7Ept.s 			page 13


 450 009e EA78     		ldrb	r2, [r5, #3]	@ zero_extendqisi2
 451 00a0 013A     		subs	r2, r2, #1
 452 00a2 1205     		lsls	r2, r2, #20
 453 00a4 02F4E002 		and	r2, r2, #7340032
 227:libcanard/drivers/stm32/canard_stm32.c ****                  (((timings->bit_segment_1 - 1U)                    &   15U) << 16U) |
 454              		.loc 1 227 0
 455 00a8 1343     		orrs	r3, r3, r2
 229:libcanard/drivers/stm32/canard_stm32.c ****                  ((timings->bit_rate_prescaler - 1U)                & 1023U) |
 456              		.loc 1 229 0
 457 00aa 2A88     		ldrh	r2, [r5]
 458 00ac 013A     		subs	r2, r2, #1
 459 00ae C2F30902 		ubfx	r2, r2, #0, #10
 228:libcanard/drivers/stm32/canard_stm32.c ****                  (((timings->bit_segment_2 - 1U)                    &    7U) << 20U) |
 460              		.loc 1 228 0
 461 00b2 1343     		orrs	r3, r3, r2
 230:libcanard/drivers/stm32/canard_stm32.c ****                  ((iface_mode == CanardSTM32IfaceModeSilent) ? CANARD_STM32_CAN_BTR_SILM : 0);
 462              		.loc 1 230 0
 463 00b4 012C     		cmp	r4, #1
 464 00b6 43D0     		beq	.L58
 465 00b8 0022     		movs	r2, #0
 466              	.L38:
 229:libcanard/drivers/stm32/canard_stm32.c ****                  ((timings->bit_rate_prescaler - 1U)                & 1023U) |
 467              		.loc 1 229 0
 468 00ba 1343     		orrs	r3, r3, r2
 226:libcanard/drivers/stm32/canard_stm32.c ****                  (((timings->bit_segment_1 - 1U)                    &   15U) << 16U) |
 469              		.loc 1 226 0
 470 00bc 3C4A     		ldr	r2, .L62+8
 471 00be D361     		str	r3, [r2, #28]
 231:libcanard/drivers/stm32/canard_stm32.c **** 
 232:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_ASSERT(0 == BXCAN->IER);             // Making sure the iterrupts are indeed disabled
 472              		.loc 1 232 0
 473 00c0 5369     		ldr	r3, [r2, #20]
 474 00c2 002B     		cmp	r3, #0
 475 00c4 3FD1     		bne	.L59
 233:libcanard/drivers/stm32/canard_stm32.c **** 
 234:libcanard/drivers/stm32/canard_stm32.c ****     BXCAN->MCR &= ~CANARD_STM32_CAN_MCR_INRQ;   // Leave init mode
 476              		.loc 1 234 0
 477 00c6 3A48     		ldr	r0, .L62+8
 478 00c8 0368     		ldr	r3, [r0]
 479 00ca 23F00103 		bic	r3, r3, #1
 480 00ce 0360     		str	r3, [r0]
 235:libcanard/drivers/stm32/canard_stm32.c **** 
 236:libcanard/drivers/stm32/canard_stm32.c ****     if (!waitMSRINAKBitStateChange(BXCAN, false))
 481              		.loc 1 236 0
 482 00d0 0021     		movs	r1, #0
 483 00d2 FFF7FEFF 		bl	waitMSRINAKBitStateChange
 484              	.LVL44:
 485 00d6 0028     		cmp	r0, #0
 486 00d8 3BD0     		beq	.L60
 487              	.LBB8:
 237:libcanard/drivers/stm32/canard_stm32.c ****     {
 238:libcanard/drivers/stm32/canard_stm32.c ****         BXCAN->MCR = CANARD_STM32_CAN_MCR_RESET;
 239:libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_STM32_ERROR_MSR_INAK_NOT_CLEARED;
 240:libcanard/drivers/stm32/canard_stm32.c ****     }
 241:libcanard/drivers/stm32/canard_stm32.c **** 
 242:libcanard/drivers/stm32/canard_stm32.c ****     /*
 243:libcanard/drivers/stm32/canard_stm32.c ****      * Default filter configuration. Note that ALL filters are available ONLY via CAN1!
ARM GAS  /tmp/cc0y7Ept.s 			page 14


 244:libcanard/drivers/stm32/canard_stm32.c ****      * CAN2 filters are offset by 14.
 245:libcanard/drivers/stm32/canard_stm32.c ****      * We use 14 filters at most always which simplifies the code and ensures compatibility with al
 246:libcanard/drivers/stm32/canard_stm32.c ****      * MCU within the STM32 family.
 247:libcanard/drivers/stm32/canard_stm32.c ****      */
 248:libcanard/drivers/stm32/canard_stm32.c ****     {
 249:libcanard/drivers/stm32/canard_stm32.c ****         uint32_t fmr = CANARD_STM32_CAN1->FMR & 0xFFFFC0F1U;
 488              		.loc 1 249 0
 489 00da 354A     		ldr	r2, .L62+8
 490 00dc D2F80032 		ldr	r3, [r2, #512]
 491 00e0 23F47C53 		bic	r3, r3, #16128
 492 00e4 23F00E03 		bic	r3, r3, #14
 493              	.LVL45:
 250:libcanard/drivers/stm32/canard_stm32.c ****         fmr |= CANARD_STM32_NUM_ACCEPTANCE_FILTERS << 8U;                // CAN2 start bank = 14 (i
 251:libcanard/drivers/stm32/canard_stm32.c ****         CANARD_STM32_CAN1->FMR = fmr | CANARD_STM32_CAN_FMR_FINIT;
 494              		.loc 1 251 0
 495 00e8 43F46063 		orr	r3, r3, #3584
 496              	.LVL46:
 497 00ec 43F00103 		orr	r3, r3, #1
 498              	.LVL47:
 499 00f0 C2F80032 		str	r3, [r2, #512]
 500              	.LBE8:
 252:libcanard/drivers/stm32/canard_stm32.c ****     }
 253:libcanard/drivers/stm32/canard_stm32.c **** 
 254:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_ASSERT(((CANARD_STM32_CAN1->FMR >> 8U) & 0x3FU) == CANARD_STM32_NUM_ACCEPTANCE_FILTERS);
 501              		.loc 1 254 0
 502 00f4 D2F80032 		ldr	r3, [r2, #512]
 503 00f8 C3F30523 		ubfx	r3, r3, #8, #6
 504 00fc 0E2B     		cmp	r3, #14
 505 00fe 2FD1     		bne	.L61
 255:libcanard/drivers/stm32/canard_stm32.c **** 
 256:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FM1R = 0;                                        // Indentifier Mask mode
 506              		.loc 1 256 0
 507 0100 2B4B     		ldr	r3, .L62+8
 508 0102 0020     		movs	r0, #0
 509 0104 C3F80402 		str	r0, [r3, #516]
 257:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FS1R = 0x0FFFFFFF;                               // All 32-bit
 510              		.loc 1 257 0
 511 0108 6FF07042 		mvn	r2, #-268435456
 512 010c C3F80C22 		str	r2, [r3, #524]
 258:libcanard/drivers/stm32/canard_stm32.c **** 
 259:libcanard/drivers/stm32/canard_stm32.c ****     // Filters are alternating between FIFO0 and FIFO1 in order to equalize the load.
 260:libcanard/drivers/stm32/canard_stm32.c ****     // This will cause occasional priority inversion and frame reordering on reception,
 261:libcanard/drivers/stm32/canard_stm32.c ****     // but that is acceptable for UAVCAN, and a majority of other protocols will tolerate
 262:libcanard/drivers/stm32/canard_stm32.c ****     // this too, since there will be no reordering within the same CAN ID.
 263:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FFA1R = 0x0AAAAAAA;
 513              		.loc 1 263 0
 514 0110 284A     		ldr	r2, .L62+12
 515 0112 C3F81422 		str	r2, [r3, #532]
 264:libcanard/drivers/stm32/canard_stm32.c **** 
 265:libcanard/drivers/stm32/canard_stm32.c **** #if CANARD_STM32_USE_CAN2
 266:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FilterRegister[CANARD_STM32_NUM_ACCEPTANCE_FILTERS].FR1 = 0;
 267:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FilterRegister[CANARD_STM32_NUM_ACCEPTANCE_FILTERS].FR2 = 0;
 268:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FA1R = (1 << CANARD_STM32_NUM_ACCEPTANCE_FILTERS);  // One filter enabled
 269:libcanard/drivers/stm32/canard_stm32.c **** #else
 270:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FilterRegister[0].FR1 = 0;
 516              		.loc 1 270 0
 517 0116 C3F84002 		str	r0, [r3, #576]
ARM GAS  /tmp/cc0y7Ept.s 			page 15


 271:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FilterRegister[0].FR2 = 0;
 518              		.loc 1 271 0
 519 011a C3F84402 		str	r0, [r3, #580]
 272:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FA1R = 1;                                        // One filter enabled
 520              		.loc 1 272 0
 521 011e 0122     		movs	r2, #1
 522 0120 C3F81C22 		str	r2, [r3, #540]
 273:libcanard/drivers/stm32/canard_stm32.c **** #endif
 274:libcanard/drivers/stm32/canard_stm32.c **** 
 275:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FMR &= ~CANARD_STM32_CAN_FMR_FINIT;              // Leave initialization mod
 523              		.loc 1 275 0
 524 0124 D3F80022 		ldr	r2, [r3, #512]
 525 0128 22F00102 		bic	r2, r2, #1
 526 012c C3F80022 		str	r2, [r3, #512]
 527              	.LVL48:
 528              	.L36:
 276:libcanard/drivers/stm32/canard_stm32.c **** 
 277:libcanard/drivers/stm32/canard_stm32.c ****     return 0;
 278:libcanard/drivers/stm32/canard_stm32.c **** }
 529              		.loc 1 278 0
 530 0130 38BD     		pop	{r3, r4, r5, pc}
 531              	.LVL49:
 532              	.L57:
 217:libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_STM32_ERROR_MSR_INAK_NOT_SET;
 533              		.loc 1 217 0
 534 0132 1F4B     		ldr	r3, .L62+8
 535 0134 4FF40042 		mov	r2, #32768
 536 0138 1A60     		str	r2, [r3]
 218:libcanard/drivers/stm32/canard_stm32.c ****     }
 537              		.loc 1 218 0
 538 013a 6FF47A70 		mvn	r0, #1000
 539 013e F7E7     		b	.L36
 540              	.L58:
 230:libcanard/drivers/stm32/canard_stm32.c **** 
 541              		.loc 1 230 0
 542 0140 4FF00042 		mov	r2, #-2147483648
 543 0144 B9E7     		b	.L38
 544              	.L59:
 232:libcanard/drivers/stm32/canard_stm32.c **** 
 545              		.loc 1 232 0 discriminator 1
 546 0146 1C4B     		ldr	r3, .L62+16
 547 0148 1C4A     		ldr	r2, .L62+20
 548 014a E821     		movs	r1, #232
 549 014c 1C48     		ldr	r0, .L62+24
 550 014e FFF7FEFF 		bl	__assert_func
 551              	.LVL50:
 552              	.L60:
 238:libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_STM32_ERROR_MSR_INAK_NOT_CLEARED;
 553              		.loc 1 238 0
 554 0152 174B     		ldr	r3, .L62+8
 555 0154 4FF40042 		mov	r2, #32768
 556 0158 1A60     		str	r2, [r3]
 239:libcanard/drivers/stm32/canard_stm32.c ****     }
 557              		.loc 1 239 0
 558 015a A0F2EA30 		subw	r0, r0, #1002
 559 015e E7E7     		b	.L36
 560              	.L61:
ARM GAS  /tmp/cc0y7Ept.s 			page 16


 254:libcanard/drivers/stm32/canard_stm32.c **** 
 561              		.loc 1 254 0 discriminator 1
 562 0160 184B     		ldr	r3, .L62+28
 563 0162 164A     		ldr	r2, .L62+20
 564 0164 FE21     		movs	r1, #254
 565 0166 1648     		ldr	r0, .L62+24
 566 0168 FFF7FEFF 		bl	__assert_func
 567              	.LVL51:
 568              	.L42:
 569              	.LCFI6:
 570              		.cfi_def_cfa_offset 0
 571              		.cfi_restore 3
 572              		.cfi_restore 4
 573              		.cfi_restore 5
 574              		.cfi_restore 14
 178:libcanard/drivers/stm32/canard_stm32.c ****     }
 575              		.loc 1 178 0
 576 016c 6FF00100 		mvn	r0, #1
 577              	.LVL52:
 578 0170 7047     		bx	lr
 579              	.LVL53:
 580              	.L43:
 187:libcanard/drivers/stm32/canard_stm32.c ****     }
 581              		.loc 1 187 0
 582 0172 6FF00100 		mvn	r0, #1
 583              	.LVL54:
 584              		.loc 1 278 0
 585 0176 7047     		bx	lr
 586              	.LVL55:
 587              	.L44:
 588              	.LCFI7:
 589              		.cfi_def_cfa_offset 16
 590              		.cfi_offset 3, -16
 591              		.cfi_offset 4, -12
 592              		.cfi_offset 5, -8
 593              		.cfi_offset 14, -4
 187:libcanard/drivers/stm32/canard_stm32.c ****     }
 594              		.loc 1 187 0
 595 0178 6FF00100 		mvn	r0, #1
 596              	.LVL56:
 597 017c D8E7     		b	.L36
 598              	.LVL57:
 599              	.L45:
 600 017e 6FF00100 		mvn	r0, #1
 601              	.LVL58:
 602 0182 D5E7     		b	.L36
 603              	.LVL59:
 604              	.L46:
 605 0184 6FF00100 		mvn	r0, #1
 606              	.LVL60:
 607 0188 D2E7     		b	.L36
 608              	.LVL61:
 609              	.L47:
 610 018a 6FF00100 		mvn	r0, #1
 611              	.LVL62:
 612 018e CFE7     		b	.L36
 613              	.LVL63:
ARM GAS  /tmp/cc0y7Ept.s 			page 17


 614              	.L48:
 615 0190 6FF00100 		mvn	r0, #1
 616              	.LVL64:
 617 0194 CCE7     		b	.L36
 618              	.LVL65:
 619              	.L49:
 620 0196 6FF00100 		mvn	r0, #1
 621              	.LVL66:
 622 019a C9E7     		b	.L36
 623              	.LVL67:
 624              	.L50:
 625 019c 6FF00100 		mvn	r0, #1
 626              	.LVL68:
 627 01a0 C6E7     		b	.L36
 628              	.LVL69:
 629              	.L51:
 630 01a2 6FF00100 		mvn	r0, #1
 631              	.LVL70:
 632 01a6 C3E7     		b	.L36
 633              	.L63:
 634              		.align	2
 635              	.L62:
 636 01a8 00000000 		.word	.LANCHOR0
 637 01ac 00000000 		.word	.LANCHOR1
 638 01b0 00640040 		.word	1073767424
 639 01b4 AAAAAA0A 		.word	178956970
 640 01b8 00000000 		.word	.LC0
 641 01bc 00000000 		.word	.LANCHOR2
 642 01c0 38000000 		.word	.LC1
 643 01c4 60000000 		.word	.LC2
 644              		.cfi_endproc
 645              	.LFE6:
 647              		.section	.text.canardSTM32Transmit,"ax",%progbits
 648              		.align	1
 649              		.global	canardSTM32Transmit
 650              		.syntax unified
 651              		.thumb
 652              		.thumb_func
 653              		.fpu softvfp
 655              	canardSTM32Transmit:
 656              	.LFB7:
 279:libcanard/drivers/stm32/canard_stm32.c **** 
 280:libcanard/drivers/stm32/canard_stm32.c **** 
 281:libcanard/drivers/stm32/canard_stm32.c **** int16_t canardSTM32Transmit(const CanardCANFrame* const frame)
 282:libcanard/drivers/stm32/canard_stm32.c **** {
 657              		.loc 1 282 0
 658              		.cfi_startproc
 659              		@ args = 0, pretend = 0, frame = 8
 660              		@ frame_needed = 0, uses_anonymous_args = 0
 661              	.LVL71:
 283:libcanard/drivers/stm32/canard_stm32.c ****     if (frame == NULL)
 662              		.loc 1 283 0
 663 0000 0028     		cmp	r0, #0
 664 0002 75D0     		beq	.L71
 282:libcanard/drivers/stm32/canard_stm32.c ****     if (frame == NULL)
 665              		.loc 1 282 0
 666 0004 70B5     		push	{r4, r5, r6, lr}
ARM GAS  /tmp/cc0y7Ept.s 			page 18


 667              	.LCFI8:
 668              		.cfi_def_cfa_offset 16
 669              		.cfi_offset 4, -16
 670              		.cfi_offset 5, -12
 671              		.cfi_offset 6, -8
 672              		.cfi_offset 14, -4
 673 0006 82B0     		sub	sp, sp, #8
 674              	.LCFI9:
 675              		.cfi_def_cfa_offset 24
 676 0008 0446     		mov	r4, r0
 284:libcanard/drivers/stm32/canard_stm32.c ****     {
 285:libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_ERROR_INVALID_ARGUMENT;
 286:libcanard/drivers/stm32/canard_stm32.c ****     }
 287:libcanard/drivers/stm32/canard_stm32.c **** 
 288:libcanard/drivers/stm32/canard_stm32.c ****     if (frame->id & CANARD_CAN_FRAME_ERR)
 677              		.loc 1 288 0
 678 000a 0368     		ldr	r3, [r0]
 679 000c 13F0005F 		tst	r3, #536870912
 680 0010 71D1     		bne	.L72
 289:libcanard/drivers/stm32/canard_stm32.c ****     {
 290:libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_STM32_ERROR_UNSUPPORTED_FRAME_FORMAT;
 291:libcanard/drivers/stm32/canard_stm32.c ****     }
 292:libcanard/drivers/stm32/canard_stm32.c **** 
 293:libcanard/drivers/stm32/canard_stm32.c ****     /*
 294:libcanard/drivers/stm32/canard_stm32.c ****      * Handling error status might free up some slots through aborts
 295:libcanard/drivers/stm32/canard_stm32.c ****      */
 296:libcanard/drivers/stm32/canard_stm32.c ****     processErrorStatus();
 681              		.loc 1 296 0
 682 0012 FFF7FEFF 		bl	processErrorStatus
 683              	.LVL72:
 297:libcanard/drivers/stm32/canard_stm32.c **** 
 298:libcanard/drivers/stm32/canard_stm32.c ****     /*
 299:libcanard/drivers/stm32/canard_stm32.c ****      * Seeking an empty slot, checking if priority inversion would occur if we enqueued now.
 300:libcanard/drivers/stm32/canard_stm32.c ****      * We can always enqueue safely if all TX mailboxes are free and no transmissions are pending.
 301:libcanard/drivers/stm32/canard_stm32.c ****      */
 302:libcanard/drivers/stm32/canard_stm32.c ****     uint8_t tx_mailbox = 0xFF;
 303:libcanard/drivers/stm32/canard_stm32.c **** 
 304:libcanard/drivers/stm32/canard_stm32.c ****     static const uint32_t AllTME = CANARD_STM32_CAN_TSR_TME0 | CANARD_STM32_CAN_TSR_TME1 | CANARD_S
 305:libcanard/drivers/stm32/canard_stm32.c **** 
 306:libcanard/drivers/stm32/canard_stm32.c ****     if ((BXCAN->TSR & AllTME) != AllTME)                // At least one TX mailbox is used, detaile
 684              		.loc 1 306 0
 685 0016 394B     		ldr	r3, .L82
 686 0018 9B68     		ldr	r3, [r3, #8]
 687 001a 03F0E053 		and	r3, r3, #469762048
 688 001e B3F1E05F 		cmp	r3, #469762048
 689 0022 63D0     		beq	.L73
 690              	.LBB9:
 307:libcanard/drivers/stm32/canard_stm32.c ****     {
 308:libcanard/drivers/stm32/canard_stm32.c ****         const bool tme[3] =
 309:libcanard/drivers/stm32/canard_stm32.c ****         {
 310:libcanard/drivers/stm32/canard_stm32.c ****             (BXCAN->TSR & CANARD_STM32_CAN_TSR_TME0) != 0,
 691              		.loc 1 310 0
 692 0024 354B     		ldr	r3, .L82
 693 0026 9A68     		ldr	r2, [r3, #8]
 694 0028 C2F38062 		ubfx	r2, r2, #26, #1
 308:libcanard/drivers/stm32/canard_stm32.c ****         {
 695              		.loc 1 308 0
ARM GAS  /tmp/cc0y7Ept.s 			page 19


 696 002c 8DF80420 		strb	r2, [sp, #4]
 311:libcanard/drivers/stm32/canard_stm32.c ****             (BXCAN->TSR & CANARD_STM32_CAN_TSR_TME1) != 0,
 697              		.loc 1 311 0
 698 0030 9A68     		ldr	r2, [r3, #8]
 699 0032 C2F3C062 		ubfx	r2, r2, #27, #1
 308:libcanard/drivers/stm32/canard_stm32.c ****         {
 700              		.loc 1 308 0
 701 0036 8DF80520 		strb	r2, [sp, #5]
 312:libcanard/drivers/stm32/canard_stm32.c ****             (BXCAN->TSR & CANARD_STM32_CAN_TSR_TME2) != 0
 702              		.loc 1 312 0
 703 003a 9B68     		ldr	r3, [r3, #8]
 704 003c C3F30073 		ubfx	r3, r3, #28, #1
 308:libcanard/drivers/stm32/canard_stm32.c ****         {
 705              		.loc 1 308 0
 706 0040 8DF80630 		strb	r3, [sp, #6]
 707              	.LVL73:
 708              	.LBB10:
 313:libcanard/drivers/stm32/canard_stm32.c ****         };
 314:libcanard/drivers/stm32/canard_stm32.c **** 
 315:libcanard/drivers/stm32/canard_stm32.c ****         for (uint8_t i = 0; i < 3; i++)
 709              		.loc 1 315 0
 710 0044 0025     		movs	r5, #0
 711              	.LBE10:
 712              	.LBE9:
 302:libcanard/drivers/stm32/canard_stm32.c **** 
 713              		.loc 1 302 0
 714 0046 FF26     		movs	r6, #255
 715              	.LBB12:
 716              	.LBB11:
 717              		.loc 1 315 0
 718 0048 02E0     		b	.L67
 719              	.LVL74:
 720              	.L74:
 316:libcanard/drivers/stm32/canard_stm32.c ****         {
 317:libcanard/drivers/stm32/canard_stm32.c ****             if (tme[i])                                 // This TX mailbox is free, we can use it
 318:libcanard/drivers/stm32/canard_stm32.c ****             {
 319:libcanard/drivers/stm32/canard_stm32.c ****                 tx_mailbox = i;
 721              		.loc 1 319 0
 722 004a 2E46     		mov	r6, r5
 723              	.LVL75:
 724              	.L68:
 315:libcanard/drivers/stm32/canard_stm32.c ****         {
 725              		.loc 1 315 0 discriminator 2
 726 004c 0135     		adds	r5, r5, #1
 727              	.LVL76:
 728 004e EDB2     		uxtb	r5, r5
 729              	.LVL77:
 730              	.L67:
 315:libcanard/drivers/stm32/canard_stm32.c ****         {
 731              		.loc 1 315 0 is_stmt 0 discriminator 1
 732 0050 022D     		cmp	r5, #2
 733 0052 13D8     		bhi	.L79
 317:libcanard/drivers/stm32/canard_stm32.c ****             {
 734              		.loc 1 317 0 is_stmt 1
 735 0054 02AB     		add	r3, sp, #8
 736 0056 2B44     		add	r3, r3, r5
 737 0058 13F8043C 		ldrb	r3, [r3, #-4]	@ zero_extendqisi2
ARM GAS  /tmp/cc0y7Ept.s 			page 20


 738 005c 002B     		cmp	r3, #0
 739 005e F4D1     		bne	.L74
 320:libcanard/drivers/stm32/canard_stm32.c ****             }
 321:libcanard/drivers/stm32/canard_stm32.c ****             else                                        // This TX mailbox is pending, check for pr
 322:libcanard/drivers/stm32/canard_stm32.c ****             {
 323:libcanard/drivers/stm32/canard_stm32.c ****                 if (!isFramePriorityHigher(frame->id, convertFrameIDRegisterToCanard(BXCAN->TxMailb
 740              		.loc 1 323 0
 741 0060 05F11803 		add	r3, r5, #24
 742 0064 1B01     		lsls	r3, r3, #4
 743 0066 254A     		ldr	r2, .L82
 744 0068 D058     		ldr	r0, [r2, r3]
 745 006a FFF7FEFF 		bl	convertFrameIDRegisterToCanard
 746              	.LVL78:
 747 006e 0146     		mov	r1, r0
 748 0070 2068     		ldr	r0, [r4]
 749 0072 FFF7FEFF 		bl	isFramePriorityHigher
 750              	.LVL79:
 751 0076 0028     		cmp	r0, #0
 752 0078 E8D1     		bne	.L68
 753 007a 27E0     		b	.L65
 754              	.L79:
 755              	.LBE11:
 324:libcanard/drivers/stm32/canard_stm32.c ****                 {
 325:libcanard/drivers/stm32/canard_stm32.c ****                     // There's a mailbox whose priority is higher or equal the priority of the new 
 326:libcanard/drivers/stm32/canard_stm32.c ****                     return 0;                           // Priority inversion would occur! Reject t
 327:libcanard/drivers/stm32/canard_stm32.c ****                 }
 328:libcanard/drivers/stm32/canard_stm32.c ****             }
 329:libcanard/drivers/stm32/canard_stm32.c ****         }
 330:libcanard/drivers/stm32/canard_stm32.c **** 
 331:libcanard/drivers/stm32/canard_stm32.c ****         if (tx_mailbox == 0xFF)
 756              		.loc 1 331 0
 757 007c FF2E     		cmp	r6, #255
 758 007e 27D0     		beq	.L80
 759              	.LBE12:
 332:libcanard/drivers/stm32/canard_stm32.c ****         {
 333:libcanard/drivers/stm32/canard_stm32.c ****             /*
 334:libcanard/drivers/stm32/canard_stm32.c ****              * All TX mailboxes are busy (this is highly unlikely); at the same time we know that t
 335:libcanard/drivers/stm32/canard_stm32.c ****              * higher or equal priority frame that is currently pending. Therefore, priority invers
 336:libcanard/drivers/stm32/canard_stm32.c ****              * just happend (sic!), because we can't enqueue the higher priority frame due to all T
 337:libcanard/drivers/stm32/canard_stm32.c ****              * being busy. This scenario is extremely unlikely, because in order for it to happen, 
 338:libcanard/drivers/stm32/canard_stm32.c ****              * would need to transmit 4 (four) or more CAN frames with different CAN ID ordered fro
 339:libcanard/drivers/stm32/canard_stm32.c ****              * low ID nearly at the same time. For example:
 340:libcanard/drivers/stm32/canard_stm32.c ****              *  1. 0x123        <-- Takes mailbox 0 (or any other)
 341:libcanard/drivers/stm32/canard_stm32.c ****              *  2. 0x122        <-- Takes mailbox 2 (or any other)
 342:libcanard/drivers/stm32/canard_stm32.c ****              *  3. 0x121        <-- Takes mailbox 1 (or any other)
 343:libcanard/drivers/stm32/canard_stm32.c ****              *  4. 0x120        <-- INNER PRIORITY INVERSION HERE (only if all three TX mailboxes a
 344:libcanard/drivers/stm32/canard_stm32.c ****              * This situation is even less likely to cause any noticeable disruptions on the CAN bu
 345:libcanard/drivers/stm32/canard_stm32.c ****              * it is better to warn the developer about that during debugging, so we fire an assert
 346:libcanard/drivers/stm32/canard_stm32.c ****              * It is perfectly safe to remove it.
 347:libcanard/drivers/stm32/canard_stm32.c ****              */
 348:libcanard/drivers/stm32/canard_stm32.c **** #if CANARD_STM32_DEBUG_INNER_PRIORITY_INVERSION
 349:libcanard/drivers/stm32/canard_stm32.c ****             CANARD_ASSERT(!"CAN PRIO INV");
 350:libcanard/drivers/stm32/canard_stm32.c **** #endif
 351:libcanard/drivers/stm32/canard_stm32.c ****             return 0;
 352:libcanard/drivers/stm32/canard_stm32.c ****         }
 353:libcanard/drivers/stm32/canard_stm32.c ****     }
 354:libcanard/drivers/stm32/canard_stm32.c ****     else                                                // All TX mailboxes are free, use first
ARM GAS  /tmp/cc0y7Ept.s 			page 21


 355:libcanard/drivers/stm32/canard_stm32.c ****     {
 356:libcanard/drivers/stm32/canard_stm32.c ****         tx_mailbox = 0;
 357:libcanard/drivers/stm32/canard_stm32.c ****     }
 358:libcanard/drivers/stm32/canard_stm32.c **** 
 359:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_ASSERT(tx_mailbox < 3);                      // Index check - the value must be correct 
 760              		.loc 1 359 0
 761 0080 022E     		cmp	r6, #2
 762 0082 2CD8     		bhi	.L81
 763              	.LVL80:
 764              	.L66:
 360:libcanard/drivers/stm32/canard_stm32.c **** 
 361:libcanard/drivers/stm32/canard_stm32.c ****     /*
 362:libcanard/drivers/stm32/canard_stm32.c ****      * By this time we've proved that a priority inversion would not occur, and we've also found a 
 363:libcanard/drivers/stm32/canard_stm32.c ****      * Therefore it is safe to enqueue the frame now.
 364:libcanard/drivers/stm32/canard_stm32.c ****      */
 365:libcanard/drivers/stm32/canard_stm32.c ****     volatile CanardSTM32TxMailboxType* const mb = &BXCAN->TxMailbox[tx_mailbox];
 765              		.loc 1 365 0
 766 0084 3501     		lsls	r5, r6, #4
 767 0086 05F18045 		add	r5, r5, #1073741824
 768 008a 05F5CB45 		add	r5, r5, #25984
 769              	.LVL81:
 366:libcanard/drivers/stm32/canard_stm32.c **** 
 367:libcanard/drivers/stm32/canard_stm32.c ****     mb->TDTR = frame->data_len;                         // DLC equals data length except in CAN FD
 770              		.loc 1 367 0
 771 008e 237B     		ldrb	r3, [r4, #12]	@ zero_extendqisi2
 772 0090 6B60     		str	r3, [r5, #4]
 368:libcanard/drivers/stm32/canard_stm32.c **** 
 369:libcanard/drivers/stm32/canard_stm32.c ****     mb->TDHR = (((uint32_t)frame->data[7]) << 24U) |
 773              		.loc 1 369 0
 774 0092 E27A     		ldrb	r2, [r4, #11]	@ zero_extendqisi2
 370:libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[6]) << 16U) |
 775              		.loc 1 370 0
 776 0094 A37A     		ldrb	r3, [r4, #10]	@ zero_extendqisi2
 777 0096 1B04     		lsls	r3, r3, #16
 369:libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[6]) << 16U) |
 778              		.loc 1 369 0
 779 0098 43EA0263 		orr	r3, r3, r2, lsl #24
 371:libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[5]) <<  8U) |
 780              		.loc 1 371 0
 781 009c 627A     		ldrb	r2, [r4, #9]	@ zero_extendqisi2
 370:libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[6]) << 16U) |
 782              		.loc 1 370 0
 783 009e 43EA0223 		orr	r3, r3, r2, lsl #8
 372:libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[4]) <<  0U);
 784              		.loc 1 372 0
 785 00a2 227A     		ldrb	r2, [r4, #8]	@ zero_extendqisi2
 371:libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[5]) <<  8U) |
 786              		.loc 1 371 0
 787 00a4 1343     		orrs	r3, r3, r2
 369:libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[6]) << 16U) |
 788              		.loc 1 369 0
 789 00a6 EB60     		str	r3, [r5, #12]
 373:libcanard/drivers/stm32/canard_stm32.c ****     mb->TDLR = (((uint32_t)frame->data[3]) << 24U) |
 790              		.loc 1 373 0
 791 00a8 E279     		ldrb	r2, [r4, #7]	@ zero_extendqisi2
 374:libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[2]) << 16U) |
 792              		.loc 1 374 0
ARM GAS  /tmp/cc0y7Ept.s 			page 22


 793 00aa A379     		ldrb	r3, [r4, #6]	@ zero_extendqisi2
 794 00ac 1B04     		lsls	r3, r3, #16
 373:libcanard/drivers/stm32/canard_stm32.c ****     mb->TDLR = (((uint32_t)frame->data[3]) << 24U) |
 795              		.loc 1 373 0
 796 00ae 43EA0263 		orr	r3, r3, r2, lsl #24
 375:libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[1]) <<  8U) |
 797              		.loc 1 375 0
 798 00b2 6279     		ldrb	r2, [r4, #5]	@ zero_extendqisi2
 374:libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[2]) << 16U) |
 799              		.loc 1 374 0
 800 00b4 43EA0223 		orr	r3, r3, r2, lsl #8
 376:libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[0]) <<  0U);
 801              		.loc 1 376 0
 802 00b8 2279     		ldrb	r2, [r4, #4]	@ zero_extendqisi2
 375:libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[1]) <<  8U) |
 803              		.loc 1 375 0
 804 00ba 1343     		orrs	r3, r3, r2
 373:libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[2]) << 16U) |
 805              		.loc 1 373 0
 806 00bc AB60     		str	r3, [r5, #8]
 377:libcanard/drivers/stm32/canard_stm32.c **** 
 378:libcanard/drivers/stm32/canard_stm32.c ****     mb->TIR = convertFrameIDCanardToRegister(frame->id) | CANARD_STM32_CAN_TIR_TXRQ;    // Go.
 807              		.loc 1 378 0
 808 00be 2068     		ldr	r0, [r4]
 809 00c0 FFF7FEFF 		bl	convertFrameIDCanardToRegister
 810              	.LVL82:
 811 00c4 40F00100 		orr	r0, r0, #1
 812 00c8 2860     		str	r0, [r5]
 379:libcanard/drivers/stm32/canard_stm32.c **** 
 380:libcanard/drivers/stm32/canard_stm32.c ****     /*
 381:libcanard/drivers/stm32/canard_stm32.c ****      * The frame is now enqueued and pending transmission.
 382:libcanard/drivers/stm32/canard_stm32.c ****      */
 383:libcanard/drivers/stm32/canard_stm32.c ****     return 1;
 813              		.loc 1 383 0
 814 00ca 0120     		movs	r0, #1
 815              	.LVL83:
 816              	.L65:
 384:libcanard/drivers/stm32/canard_stm32.c **** }
 817              		.loc 1 384 0
 818 00cc 02B0     		add	sp, sp, #8
 819              	.LCFI10:
 820              		.cfi_remember_state
 821              		.cfi_def_cfa_offset 16
 822              		@ sp needed
 823 00ce 70BD     		pop	{r4, r5, r6, pc}
 824              	.LVL84:
 825              	.L80:
 826              	.LCFI11:
 827              		.cfi_restore_state
 828              	.LBB13:
 349:libcanard/drivers/stm32/canard_stm32.c **** #endif
 829              		.loc 1 349 0
 830 00d0 0B4B     		ldr	r3, .L82+4
 831 00d2 0C4A     		ldr	r2, .L82+8
 832 00d4 40F25D11 		movw	r1, #349
 833 00d8 0B48     		ldr	r0, .L82+12
 834 00da FFF7FEFF 		bl	__assert_func
ARM GAS  /tmp/cc0y7Ept.s 			page 23


 835              	.LVL85:
 836              	.L81:
 837              	.LBE13:
 359:libcanard/drivers/stm32/canard_stm32.c **** 
 838              		.loc 1 359 0 discriminator 1
 839 00de 0B4B     		ldr	r3, .L82+16
 840 00e0 084A     		ldr	r2, .L82+8
 841 00e2 40F26711 		movw	r1, #359
 842 00e6 0848     		ldr	r0, .L82+12
 843 00e8 FFF7FEFF 		bl	__assert_func
 844              	.LVL86:
 845              	.L73:
 356:libcanard/drivers/stm32/canard_stm32.c ****     }
 846              		.loc 1 356 0
 847 00ec 0026     		movs	r6, #0
 848 00ee C9E7     		b	.L66
 849              	.LVL87:
 850              	.L71:
 851              	.LCFI12:
 852              		.cfi_def_cfa_offset 0
 853              		.cfi_restore 4
 854              		.cfi_restore 5
 855              		.cfi_restore 6
 856              		.cfi_restore 14
 285:libcanard/drivers/stm32/canard_stm32.c ****     }
 857              		.loc 1 285 0
 858 00f0 6FF00100 		mvn	r0, #1
 859              	.LVL88:
 860              		.loc 1 384 0
 861 00f4 7047     		bx	lr
 862              	.LVL89:
 863              	.L72:
 864              	.LCFI13:
 865              		.cfi_def_cfa_offset 24
 866              		.cfi_offset 4, -16
 867              		.cfi_offset 5, -12
 868              		.cfi_offset 6, -8
 869              		.cfi_offset 14, -4
 290:libcanard/drivers/stm32/canard_stm32.c ****     }
 870              		.loc 1 290 0
 871 00f6 0648     		ldr	r0, .L82+20
 872              	.LVL90:
 873 00f8 E8E7     		b	.L65
 874              	.L83:
 875 00fa 00BF     		.align	2
 876              	.L82:
 877 00fc 00640040 		.word	1073767424
 878 0100 00000000 		.word	.LC3
 879 0104 00000000 		.word	.LANCHOR3
 880 0108 38000000 		.word	.LC1
 881 010c 10000000 		.word	.LC4
 882 0110 15FCFFFF 		.word	-1003
 883              		.cfi_endproc
 884              	.LFE7:
 886              		.section	.text.canardSTM32Receive,"ax",%progbits
 887              		.align	1
 888              		.global	canardSTM32Receive
ARM GAS  /tmp/cc0y7Ept.s 			page 24


 889              		.syntax unified
 890              		.thumb
 891              		.thumb_func
 892              		.fpu softvfp
 894              	canardSTM32Receive:
 895              	.LFB8:
 385:libcanard/drivers/stm32/canard_stm32.c **** 
 386:libcanard/drivers/stm32/canard_stm32.c **** 
 387:libcanard/drivers/stm32/canard_stm32.c **** int16_t canardSTM32Receive(CanardCANFrame* const out_frame)
 388:libcanard/drivers/stm32/canard_stm32.c **** {
 896              		.loc 1 388 0
 897              		.cfi_startproc
 898              		@ args = 0, pretend = 0, frame = 0
 899              		@ frame_needed = 0, uses_anonymous_args = 0
 900              	.LVL91:
 389:libcanard/drivers/stm32/canard_stm32.c ****     if (out_frame == NULL)
 901              		.loc 1 389 0
 902 0000 0028     		cmp	r0, #0
 903 0002 43D0     		beq	.L90
 388:libcanard/drivers/stm32/canard_stm32.c ****     if (out_frame == NULL)
 904              		.loc 1 388 0
 905 0004 2DE97848 		push	{r3, r4, r5, r6, fp, lr}
 906              	.LCFI14:
 907              		.cfi_def_cfa_offset 24
 908              		.cfi_offset 3, -24
 909              		.cfi_offset 4, -20
 910              		.cfi_offset 5, -16
 911              		.cfi_offset 6, -12
 912              		.cfi_offset 11, -8
 913              		.cfi_offset 14, -4
 914 0008 0546     		mov	r5, r0
 390:libcanard/drivers/stm32/canard_stm32.c ****     {
 391:libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_ERROR_INVALID_ARGUMENT;
 392:libcanard/drivers/stm32/canard_stm32.c ****     }
 393:libcanard/drivers/stm32/canard_stm32.c **** 
 394:libcanard/drivers/stm32/canard_stm32.c ****     static volatile uint32_t* const RFxR[2] =
 395:libcanard/drivers/stm32/canard_stm32.c ****     {
 396:libcanard/drivers/stm32/canard_stm32.c ****         &BXCAN->RF0R,
 397:libcanard/drivers/stm32/canard_stm32.c ****         &BXCAN->RF1R
 398:libcanard/drivers/stm32/canard_stm32.c ****     };
 399:libcanard/drivers/stm32/canard_stm32.c **** 
 400:libcanard/drivers/stm32/canard_stm32.c ****     /*
 401:libcanard/drivers/stm32/canard_stm32.c ****      * This function must be polled periodically, so we use this opportunity to do it.
 402:libcanard/drivers/stm32/canard_stm32.c ****      */
 403:libcanard/drivers/stm32/canard_stm32.c ****     processErrorStatus();
 915              		.loc 1 403 0
 916 000a FFF7FEFF 		bl	processErrorStatus
 917              	.LVL92:
 918              	.LBB14:
 404:libcanard/drivers/stm32/canard_stm32.c **** 
 405:libcanard/drivers/stm32/canard_stm32.c ****     /*
 406:libcanard/drivers/stm32/canard_stm32.c ****      * Reading the TX FIFO
 407:libcanard/drivers/stm32/canard_stm32.c ****      */
 408:libcanard/drivers/stm32/canard_stm32.c ****     for (uint_fast8_t i = 0; i < 2; i++)
 919              		.loc 1 408 0
 920 000e 0023     		movs	r3, #0
 921              	.LVL93:
ARM GAS  /tmp/cc0y7Ept.s 			page 25


 922              	.L86:
 923              		.loc 1 408 0 is_stmt 0 discriminator 1
 924 0010 012B     		cmp	r3, #1
 925 0012 38D8     		bhi	.L95
 926              	.LBB15:
 409:libcanard/drivers/stm32/canard_stm32.c ****     {
 410:libcanard/drivers/stm32/canard_stm32.c ****         volatile CanardSTM32RxMailboxType* const mb = &BXCAN->RxMailbox[i];
 927              		.loc 1 410 0 is_stmt 1
 928 0014 1F4C     		ldr	r4, .L97
 929 0016 04EB0314 		add	r4, r4, r3, lsl #4
 930              	.LVL94:
 411:libcanard/drivers/stm32/canard_stm32.c **** 
 412:libcanard/drivers/stm32/canard_stm32.c ****         if (((*RFxR[i]) & CANARD_STM32_CAN_RFR_FMP_MASK) != 0)
 931              		.loc 1 412 0
 932 001a 1F4A     		ldr	r2, .L97+4
 933 001c 52F82360 		ldr	r6, [r2, r3, lsl #2]
 934 0020 3268     		ldr	r2, [r6]
 935 0022 12F0030F 		tst	r2, #3
 936 0026 01D1     		bne	.L96
 937              	.LBE15:
 408:libcanard/drivers/stm32/canard_stm32.c ****     {
 938              		.loc 1 408 0 discriminator 2
 939 0028 0133     		adds	r3, r3, #1
 940              	.LVL95:
 941 002a F1E7     		b	.L86
 942              	.L96:
 943              	.LBB17:
 944              	.LBB16:
 413:libcanard/drivers/stm32/canard_stm32.c ****         {
 414:libcanard/drivers/stm32/canard_stm32.c ****             if (*RFxR[i] & CANARD_STM32_CAN_RFR_FOVR)
 945              		.loc 1 414 0
 946 002c 3368     		ldr	r3, [r6]
 947              	.LVL96:
 948 002e 13F0100F 		tst	r3, #16
 949 0032 08D0     		beq	.L88
 415:libcanard/drivers/stm32/canard_stm32.c ****             {
 416:libcanard/drivers/stm32/canard_stm32.c ****                 g_stats.rx_overflow_count++;
 950              		.loc 1 416 0
 951 0034 1949     		ldr	r1, .L97+8
 952 0036 D1E900BC 		ldrd	fp, [r1]
 953 003a 1BF10102 		adds	r2, fp, #1
 954 003e 4CF10003 		adc	r3, ip, #0
 955 0042 C1E90023 		strd	r2, [r1]
 956              	.L88:
 417:libcanard/drivers/stm32/canard_stm32.c ****             }
 418:libcanard/drivers/stm32/canard_stm32.c **** 
 419:libcanard/drivers/stm32/canard_stm32.c ****             out_frame->id = convertFrameIDRegisterToCanard(mb->RIR);
 957              		.loc 1 419 0
 958 0046 2068     		ldr	r0, [r4]
 959 0048 FFF7FEFF 		bl	convertFrameIDRegisterToCanard
 960              	.LVL97:
 961 004c 2860     		str	r0, [r5]
 420:libcanard/drivers/stm32/canard_stm32.c **** 
 421:libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data_len = (uint8_t)(mb->RDTR & CANARD_STM32_CAN_RDTR_DLC_MASK);
 962              		.loc 1 421 0
 963 004e 6368     		ldr	r3, [r4, #4]
 964 0050 03F00F03 		and	r3, r3, #15
ARM GAS  /tmp/cc0y7Ept.s 			page 26


 965 0054 2B73     		strb	r3, [r5, #12]
 422:libcanard/drivers/stm32/canard_stm32.c **** 
 423:libcanard/drivers/stm32/canard_stm32.c ****             // Caching to regular (non volatile) memory for faster reads
 424:libcanard/drivers/stm32/canard_stm32.c ****             const uint32_t rdlr = mb->RDLR;
 966              		.loc 1 424 0
 967 0056 A268     		ldr	r2, [r4, #8]
 968              	.LVL98:
 425:libcanard/drivers/stm32/canard_stm32.c ****             const uint32_t rdhr = mb->RDHR;
 969              		.loc 1 425 0
 970 0058 E368     		ldr	r3, [r4, #12]
 971              	.LVL99:
 426:libcanard/drivers/stm32/canard_stm32.c **** 
 427:libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data[0] = (uint8_t)(0xFFU & (rdlr >>  0U));
 972              		.loc 1 427 0
 973 005a 2A71     		strb	r2, [r5, #4]
 428:libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data[1] = (uint8_t)(0xFFU & (rdlr >>  8U));
 974              		.loc 1 428 0
 975 005c C2F30721 		ubfx	r1, r2, #8, #8
 976 0060 6971     		strb	r1, [r5, #5]
 429:libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data[2] = (uint8_t)(0xFFU & (rdlr >> 16U));
 977              		.loc 1 429 0
 978 0062 C2F30741 		ubfx	r1, r2, #16, #8
 979 0066 A971     		strb	r1, [r5, #6]
 430:libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data[3] = (uint8_t)(0xFFU & (rdlr >> 24U));
 980              		.loc 1 430 0
 981 0068 120E     		lsrs	r2, r2, #24
 982              	.LVL100:
 983 006a EA71     		strb	r2, [r5, #7]
 431:libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data[4] = (uint8_t)(0xFFU & (rdhr >>  0U));
 984              		.loc 1 431 0
 985 006c 2B72     		strb	r3, [r5, #8]
 432:libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data[5] = (uint8_t)(0xFFU & (rdhr >>  8U));
 986              		.loc 1 432 0
 987 006e C3F30722 		ubfx	r2, r3, #8, #8
 988 0072 6A72     		strb	r2, [r5, #9]
 433:libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data[6] = (uint8_t)(0xFFU & (rdhr >> 16U));
 989              		.loc 1 433 0
 990 0074 C3F30742 		ubfx	r2, r3, #16, #8
 991 0078 AA72     		strb	r2, [r5, #10]
 434:libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data[7] = (uint8_t)(0xFFU & (rdhr >> 24U));
 992              		.loc 1 434 0
 993 007a 1B0E     		lsrs	r3, r3, #24
 994              	.LVL101:
 995 007c EB72     		strb	r3, [r5, #11]
 435:libcanard/drivers/stm32/canard_stm32.c **** 
 436:libcanard/drivers/stm32/canard_stm32.c ****             // Release FIFO entry we just read
 437:libcanard/drivers/stm32/canard_stm32.c ****             *RFxR[i] = CANARD_STM32_CAN_RFR_RFOM | CANARD_STM32_CAN_RFR_FOVR | CANARD_STM32_CAN_RFR
 996              		.loc 1 437 0
 997 007e 3823     		movs	r3, #56
 998 0080 3360     		str	r3, [r6]
 438:libcanard/drivers/stm32/canard_stm32.c **** 
 439:libcanard/drivers/stm32/canard_stm32.c ****             // Reading successful
 440:libcanard/drivers/stm32/canard_stm32.c ****             return 1;
 999              		.loc 1 440 0
 1000 0082 0120     		movs	r0, #1
 1001 0084 00E0     		b	.L85
 1002              	.LVL102:
ARM GAS  /tmp/cc0y7Ept.s 			page 27


 1003              	.L95:
 1004              	.LBE16:
 1005              	.LBE17:
 1006              	.LBE14:
 441:libcanard/drivers/stm32/canard_stm32.c ****         }
 442:libcanard/drivers/stm32/canard_stm32.c ****     }
 443:libcanard/drivers/stm32/canard_stm32.c **** 
 444:libcanard/drivers/stm32/canard_stm32.c ****     // No frames to read
 445:libcanard/drivers/stm32/canard_stm32.c ****     return 0;
 1007              		.loc 1 445 0
 1008 0086 0020     		movs	r0, #0
 1009              	.LVL103:
 1010              	.L85:
 446:libcanard/drivers/stm32/canard_stm32.c **** }
 1011              		.loc 1 446 0
 1012 0088 BDE87888 		pop	{r3, r4, r5, r6, fp, pc}
 1013              	.LVL104:
 1014              	.L90:
 1015              	.LCFI15:
 1016              		.cfi_def_cfa_offset 0
 1017              		.cfi_restore 3
 1018              		.cfi_restore 4
 1019              		.cfi_restore 5
 1020              		.cfi_restore 6
 1021              		.cfi_restore 11
 1022              		.cfi_restore 14
 391:libcanard/drivers/stm32/canard_stm32.c ****     }
 1023              		.loc 1 391 0
 1024 008c 6FF00100 		mvn	r0, #1
 1025              	.LVL105:
 1026              		.loc 1 446 0
 1027 0090 7047     		bx	lr
 1028              	.L98:
 1029 0092 00BF     		.align	2
 1030              	.L97:
 1031 0094 B0650040 		.word	1073767856
 1032 0098 00000000 		.word	.LANCHOR4
 1033 009c 00000000 		.word	.LANCHOR0
 1034              		.cfi_endproc
 1035              	.LFE8:
 1037              		.section	.text.canardSTM32ConfigureAcceptanceFilters,"ax",%progbits
 1038              		.align	1
 1039              		.global	canardSTM32ConfigureAcceptanceFilters
 1040              		.syntax unified
 1041              		.thumb
 1042              		.thumb_func
 1043              		.fpu softvfp
 1045              	canardSTM32ConfigureAcceptanceFilters:
 1046              	.LFB9:
 447:libcanard/drivers/stm32/canard_stm32.c **** 
 448:libcanard/drivers/stm32/canard_stm32.c **** 
 449:libcanard/drivers/stm32/canard_stm32.c **** int16_t canardSTM32ConfigureAcceptanceFilters(const CanardSTM32AcceptanceFilterConfiguration* const
 450:libcanard/drivers/stm32/canard_stm32.c ****                                               const uint8_t num_filter_configs)
 451:libcanard/drivers/stm32/canard_stm32.c **** {
 1047              		.loc 1 451 0
 1048              		.cfi_startproc
 1049              		@ args = 0, pretend = 0, frame = 0
ARM GAS  /tmp/cc0y7Ept.s 			page 28


 1050              		@ frame_needed = 0, uses_anonymous_args = 0
 1051              		@ link register save eliminated.
 1052              	.LVL106:
 452:libcanard/drivers/stm32/canard_stm32.c ****     // Note that num_filter_configs = 0 is a valid configuration, which rejects all frames.
 453:libcanard/drivers/stm32/canard_stm32.c ****     if ((filter_configs == NULL) ||
 1053              		.loc 1 453 0
 1054 0000 0028     		cmp	r0, #0
 1055 0002 3FD0     		beq	.L109
 451:libcanard/drivers/stm32/canard_stm32.c ****     // Note that num_filter_configs = 0 is a valid configuration, which rejects all frames.
 1056              		.loc 1 451 0 discriminator 1
 1057 0004 70B4     		push	{r4, r5, r6}
 1058              	.LCFI16:
 1059              		.cfi_def_cfa_offset 12
 1060              		.cfi_offset 4, -12
 1061              		.cfi_offset 5, -8
 1062              		.cfi_offset 6, -4
 1063 0006 0646     		mov	r6, r0
 1064              		.loc 1 453 0 discriminator 1
 1065 0008 0E29     		cmp	r1, #14
 1066 000a 3ED8     		bhi	.L110
 454:libcanard/drivers/stm32/canard_stm32.c ****         (num_filter_configs > CANARD_STM32_NUM_ACCEPTANCE_FILTERS))
 455:libcanard/drivers/stm32/canard_stm32.c ****     {
 456:libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_ERROR_INVALID_ARGUMENT;
 457:libcanard/drivers/stm32/canard_stm32.c ****     }
 458:libcanard/drivers/stm32/canard_stm32.c **** 
 459:libcanard/drivers/stm32/canard_stm32.c ****     /*
 460:libcanard/drivers/stm32/canard_stm32.c ****      * First we disable all filters. This may cause momentary RX frame losses, but the application
 461:libcanard/drivers/stm32/canard_stm32.c ****      * should be able to tolerate that.
 462:libcanard/drivers/stm32/canard_stm32.c ****      */
 463:libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FA1R = 0;
 1067              		.loc 1 463 0
 1068 000c 0023     		movs	r3, #0
 1069 000e 204A     		ldr	r2, .L117
 1070 0010 C2F81C32 		str	r3, [r2, #540]
 1071              	.LVL107:
 1072              	.LBB18:
 464:libcanard/drivers/stm32/canard_stm32.c **** 
 465:libcanard/drivers/stm32/canard_stm32.c ****     /*
 466:libcanard/drivers/stm32/canard_stm32.c ****      * Having filters disabled we can update the configuration.
 467:libcanard/drivers/stm32/canard_stm32.c ****      * Register mapping: FR1 - ID, FR2 - Mask
 468:libcanard/drivers/stm32/canard_stm32.c ****      */
 469:libcanard/drivers/stm32/canard_stm32.c ****     for (uint8_t i = 0; i < num_filter_configs; i++)
 1073              		.loc 1 469 0
 1074 0014 22E0     		b	.L101
 1075              	.LVL108:
 1076              	.L102:
 1077              	.LBB19:
 470:libcanard/drivers/stm32/canard_stm32.c ****     {
 471:libcanard/drivers/stm32/canard_stm32.c ****         /*
 472:libcanard/drivers/stm32/canard_stm32.c ****          * Converting the ID and the Mask into the representation that can be chewed by the hardwar
 473:libcanard/drivers/stm32/canard_stm32.c ****          * If Mask asks us to accept both STDID and EXTID, we need to use EXT mode on the filter,
 474:libcanard/drivers/stm32/canard_stm32.c ****          * otherwise it will reject all EXTID frames. This logic is not documented in the RM.
 475:libcanard/drivers/stm32/canard_stm32.c ****          *
 476:libcanard/drivers/stm32/canard_stm32.c ****          * The logic of the hardware acceptance filters can be described as follows:
 477:libcanard/drivers/stm32/canard_stm32.c ****          *
 478:libcanard/drivers/stm32/canard_stm32.c ****          *  accepted = (received_id & filter_mask) == (filter_id & filter_mask)
 479:libcanard/drivers/stm32/canard_stm32.c ****          *
ARM GAS  /tmp/cc0y7Ept.s 			page 29


 480:libcanard/drivers/stm32/canard_stm32.c ****          * Where:
 481:libcanard/drivers/stm32/canard_stm32.c ****          *  - accepted      - if true, the frame will be accepted by the filter.
 482:libcanard/drivers/stm32/canard_stm32.c ****          *  - received_id   - the CAN ID of the received frame, either 11-bit or 29-bit, with exten
 483:libcanard/drivers/stm32/canard_stm32.c ****          *                    marking extended frames, error frames, etc.
 484:libcanard/drivers/stm32/canard_stm32.c ****          *  - filter_id     - the value of the filter ID register.
 485:libcanard/drivers/stm32/canard_stm32.c ****          *  - filter_mask   - the value of the filter mask register.
 486:libcanard/drivers/stm32/canard_stm32.c ****          *
 487:libcanard/drivers/stm32/canard_stm32.c ****          * There are special bits that are not members of the CAN ID field:
 488:libcanard/drivers/stm32/canard_stm32.c ****          *  - EFF - set for extended frames (29-bit), cleared for standard frames (11-bit)
 489:libcanard/drivers/stm32/canard_stm32.c ****          *  - RTR - like above, indicates Remote Transmission Request frames.
 490:libcanard/drivers/stm32/canard_stm32.c ****          *
 491:libcanard/drivers/stm32/canard_stm32.c ****          * The following truth table summarizes the logic (where: FM - filter mask, FID - filter ID
 492:libcanard/drivers/stm32/canard_stm32.c ****          * frame ID, A - true if accepted, X - any state):
 493:libcanard/drivers/stm32/canard_stm32.c ****          *
 494:libcanard/drivers/stm32/canard_stm32.c ****          *  FM  FID RID A
 495:libcanard/drivers/stm32/canard_stm32.c ****          *  0   X   X   1
 496:libcanard/drivers/stm32/canard_stm32.c ****          *  1   0   0   1
 497:libcanard/drivers/stm32/canard_stm32.c ****          *  1   1   0   0
 498:libcanard/drivers/stm32/canard_stm32.c ****          *  1   0   1   0
 499:libcanard/drivers/stm32/canard_stm32.c ****          *  1   1   1   1
 500:libcanard/drivers/stm32/canard_stm32.c ****          *
 501:libcanard/drivers/stm32/canard_stm32.c ****          * One would expect that for the purposes of hardware filtering, the special bits should be
 502:libcanard/drivers/stm32/canard_stm32.c ****          * in the same way as the real ID bits. However, this is not the case with bxCAN. The follo
 503:libcanard/drivers/stm32/canard_stm32.c ****          * table has been determined empirically (this behavior was not documented as of 2017):
 504:libcanard/drivers/stm32/canard_stm32.c ****          *
 505:libcanard/drivers/stm32/canard_stm32.c ****          *  FM  FID RID A
 506:libcanard/drivers/stm32/canard_stm32.c ****          *  0   0   0   1
 507:libcanard/drivers/stm32/canard_stm32.c ****          *  0   0   1   0       <-- frame rejected!
 508:libcanard/drivers/stm32/canard_stm32.c ****          *  0   1   X   1
 509:libcanard/drivers/stm32/canard_stm32.c ****          *  1   0   0   1
 510:libcanard/drivers/stm32/canard_stm32.c ****          *  1   1   0   0
 511:libcanard/drivers/stm32/canard_stm32.c ****          *  1   0   1   0
 512:libcanard/drivers/stm32/canard_stm32.c ****          *  1   1   1   1
 513:libcanard/drivers/stm32/canard_stm32.c ****          */
 514:libcanard/drivers/stm32/canard_stm32.c ****         uint32_t id   = 0;
 515:libcanard/drivers/stm32/canard_stm32.c ****         uint32_t mask = 0;
 516:libcanard/drivers/stm32/canard_stm32.c **** 
 517:libcanard/drivers/stm32/canard_stm32.c ****         const CanardSTM32AcceptanceFilterConfiguration* const cfg = filter_configs + i;
 518:libcanard/drivers/stm32/canard_stm32.c **** 
 519:libcanard/drivers/stm32/canard_stm32.c ****         if ((cfg->id & CANARD_CAN_FRAME_EFF) || !(cfg->mask & CANARD_CAN_FRAME_EFF))
 520:libcanard/drivers/stm32/canard_stm32.c ****         {
 521:libcanard/drivers/stm32/canard_stm32.c ****             id   = (cfg->id   & CANARD_CAN_EXT_ID_MASK) << 3U;
 1078              		.loc 1 521 0
 1079 0016 E000     		lsls	r0, r4, #3
 1080              	.LVL109:
 522:libcanard/drivers/stm32/canard_stm32.c ****             mask = (cfg->mask & CANARD_CAN_EXT_ID_MASK) << 3U;
 1081              		.loc 1 522 0
 1082 0018 6A68     		ldr	r2, [r5, #4]
 1083 001a D200     		lsls	r2, r2, #3
 1084              	.LVL110:
 523:libcanard/drivers/stm32/canard_stm32.c ****             id |= CANARD_STM32_CAN_RIR_IDE;
 1085              		.loc 1 523 0
 1086 001c 40F00400 		orr	r0, r0, #4
 1087              	.LVL111:
 1088              	.L104:
 524:libcanard/drivers/stm32/canard_stm32.c ****         }
 525:libcanard/drivers/stm32/canard_stm32.c ****         else
ARM GAS  /tmp/cc0y7Ept.s 			page 30


 526:libcanard/drivers/stm32/canard_stm32.c ****         {
 527:libcanard/drivers/stm32/canard_stm32.c ****             id   = (cfg->id   & CANARD_CAN_STD_ID_MASK) << 21U;
 528:libcanard/drivers/stm32/canard_stm32.c ****             mask = (cfg->mask & CANARD_CAN_STD_ID_MASK) << 21U;
 529:libcanard/drivers/stm32/canard_stm32.c ****         }
 530:libcanard/drivers/stm32/canard_stm32.c **** 
 531:libcanard/drivers/stm32/canard_stm32.c ****         if (cfg->id & CANARD_CAN_FRAME_RTR)
 1089              		.loc 1 531 0
 1090 0020 14F0804F 		tst	r4, #1073741824
 1091 0024 01D0     		beq	.L105
 532:libcanard/drivers/stm32/canard_stm32.c ****         {
 533:libcanard/drivers/stm32/canard_stm32.c ****             id |= CANARD_STM32_CAN_RIR_RTR;
 1092              		.loc 1 533 0
 1093 0026 40F00200 		orr	r0, r0, #2
 1094              	.LVL112:
 1095              	.L105:
 534:libcanard/drivers/stm32/canard_stm32.c ****         }
 535:libcanard/drivers/stm32/canard_stm32.c **** 
 536:libcanard/drivers/stm32/canard_stm32.c ****         if (cfg->mask & CANARD_CAN_FRAME_EFF)
 1096              		.loc 1 536 0
 1097 002a 6C68     		ldr	r4, [r5, #4]
 1098 002c 002C     		cmp	r4, #0
 1099 002e 23DB     		blt	.L115
 1100              	.L106:
 537:libcanard/drivers/stm32/canard_stm32.c ****         {
 538:libcanard/drivers/stm32/canard_stm32.c ****             mask |= CANARD_STM32_CAN_RIR_IDE;
 539:libcanard/drivers/stm32/canard_stm32.c ****         }
 540:libcanard/drivers/stm32/canard_stm32.c **** 
 541:libcanard/drivers/stm32/canard_stm32.c ****         if (cfg->mask & CANARD_CAN_FRAME_RTR)
 1101              		.loc 1 541 0
 1102 0030 14F0804F 		tst	r4, #1073741824
 1103 0034 01D0     		beq	.L107
 542:libcanard/drivers/stm32/canard_stm32.c ****         {
 543:libcanard/drivers/stm32/canard_stm32.c ****             mask |= CANARD_STM32_CAN_RIR_RTR;
 1104              		.loc 1 543 0
 1105 0036 42F00202 		orr	r2, r2, #2
 1106              	.LVL113:
 1107              	.L107:
 544:libcanard/drivers/stm32/canard_stm32.c ****         }
 545:libcanard/drivers/stm32/canard_stm32.c **** 
 546:libcanard/drivers/stm32/canard_stm32.c ****         /*
 547:libcanard/drivers/stm32/canard_stm32.c ****          * Applying the converted representation to the registers.
 548:libcanard/drivers/stm32/canard_stm32.c ****          */
 549:libcanard/drivers/stm32/canard_stm32.c ****         const uint8_t filter_index =
 550:libcanard/drivers/stm32/canard_stm32.c **** #if CANARD_STM32_USE_CAN2
 551:libcanard/drivers/stm32/canard_stm32.c ****             (uint8_t)(i + CANARD_STM32_NUM_ACCEPTANCE_FILTERS);
 552:libcanard/drivers/stm32/canard_stm32.c **** #else
 553:libcanard/drivers/stm32/canard_stm32.c ****             i;
 554:libcanard/drivers/stm32/canard_stm32.c **** #endif
 555:libcanard/drivers/stm32/canard_stm32.c ****         CANARD_STM32_CAN1->FilterRegister[filter_index].FR1 = id;
 1108              		.loc 1 555 0 discriminator 2
 1109 003a 154C     		ldr	r4, .L117
 1110 003c 03F14805 		add	r5, r3, #72
 1111              	.LVL114:
 1112 0040 44F83500 		str	r0, [r4, r5, lsl #3]
 556:libcanard/drivers/stm32/canard_stm32.c ****         CANARD_STM32_CAN1->FilterRegister[filter_index].FR2 = mask;
 1113              		.loc 1 556 0 discriminator 2
 1114 0044 04EBC505 		add	r5, r4, r5, lsl #3
ARM GAS  /tmp/cc0y7Ept.s 			page 31


 1115 0048 6A60     		str	r2, [r5, #4]
 557:libcanard/drivers/stm32/canard_stm32.c **** 
 558:libcanard/drivers/stm32/canard_stm32.c ****         CANARD_STM32_CAN1->FA1R |= 1U << filter_index;      // Enable
 1116              		.loc 1 558 0 discriminator 2
 1117 004a D4F81C22 		ldr	r2, [r4, #540]
 1118              	.LVL115:
 1119 004e 0120     		movs	r0, #1
 1120              	.LVL116:
 1121 0050 9840     		lsls	r0, r0, r3
 1122 0052 0243     		orrs	r2, r2, r0
 1123 0054 C4F81C22 		str	r2, [r4, #540]
 1124              	.LVL117:
 1125              	.LBE19:
 469:libcanard/drivers/stm32/canard_stm32.c ****     {
 1126              		.loc 1 469 0 discriminator 2
 1127 0058 0133     		adds	r3, r3, #1
 1128              	.LVL118:
 1129 005a DBB2     		uxtb	r3, r3
 1130              	.LVL119:
 1131              	.L101:
 469:libcanard/drivers/stm32/canard_stm32.c ****     {
 1132              		.loc 1 469 0 is_stmt 0 discriminator 1
 1133 005c 8B42     		cmp	r3, r1
 1134 005e 0ED2     		bcs	.L116
 1135              	.LVL120:
 1136              	.LBB20:
 517:libcanard/drivers/stm32/canard_stm32.c **** 
 1137              		.loc 1 517 0 is_stmt 1
 1138 0060 06EBC305 		add	r5, r6, r3, lsl #3
 1139              	.LVL121:
 519:libcanard/drivers/stm32/canard_stm32.c ****         {
 1140              		.loc 1 519 0
 1141 0064 56F83340 		ldr	r4, [r6, r3, lsl #3]
 1142 0068 002C     		cmp	r4, #0
 1143 006a D4DB     		blt	.L102
 519:libcanard/drivers/stm32/canard_stm32.c ****         {
 1144              		.loc 1 519 0 is_stmt 0 discriminator 1
 1145 006c 6A68     		ldr	r2, [r5, #4]
 1146 006e 002A     		cmp	r2, #0
 1147 0070 D1DA     		bge	.L102
 527:libcanard/drivers/stm32/canard_stm32.c ****             mask = (cfg->mask & CANARD_CAN_STD_ID_MASK) << 21U;
 1148              		.loc 1 527 0 is_stmt 1
 1149 0072 6005     		lsls	r0, r4, #21
 1150              	.LVL122:
 528:libcanard/drivers/stm32/canard_stm32.c ****         }
 1151              		.loc 1 528 0
 1152 0074 5205     		lsls	r2, r2, #21
 1153              	.LVL123:
 1154 0076 D3E7     		b	.L104
 1155              	.L115:
 538:libcanard/drivers/stm32/canard_stm32.c ****         }
 1156              		.loc 1 538 0
 1157 0078 42F00402 		orr	r2, r2, #4
 1158              	.LVL124:
 1159 007c D8E7     		b	.L106
 1160              	.LVL125:
 1161              	.L116:
ARM GAS  /tmp/cc0y7Ept.s 			page 32


 1162              	.LBE20:
 1163              	.LBE18:
 559:libcanard/drivers/stm32/canard_stm32.c ****     }
 560:libcanard/drivers/stm32/canard_stm32.c **** 
 561:libcanard/drivers/stm32/canard_stm32.c ****     return 0;
 1164              		.loc 1 561 0
 1165 007e 0020     		movs	r0, #0
 1166              	.LVL126:
 1167              	.L100:
 562:libcanard/drivers/stm32/canard_stm32.c **** }
 1168              		.loc 1 562 0
 1169 0080 70BC     		pop	{r4, r5, r6}
 1170              	.LCFI17:
 1171              		.cfi_restore 6
 1172              		.cfi_restore 5
 1173              		.cfi_restore 4
 1174              		.cfi_def_cfa_offset 0
 1175              	.LVL127:
 1176 0082 7047     		bx	lr
 1177              	.LVL128:
 1178              	.L109:
 456:libcanard/drivers/stm32/canard_stm32.c ****     }
 1179              		.loc 1 456 0
 1180 0084 6FF00100 		mvn	r0, #1
 1181              	.LVL129:
 1182              		.loc 1 562 0
 1183 0088 7047     		bx	lr
 1184              	.LVL130:
 1185              	.L110:
 1186              	.LCFI18:
 1187              		.cfi_def_cfa_offset 12
 1188              		.cfi_offset 4, -12
 1189              		.cfi_offset 5, -8
 1190              		.cfi_offset 6, -4
 456:libcanard/drivers/stm32/canard_stm32.c ****     }
 1191              		.loc 1 456 0
 1192 008a 6FF00100 		mvn	r0, #1
 1193              	.LVL131:
 1194 008e F7E7     		b	.L100
 1195              	.L118:
 1196              		.align	2
 1197              	.L117:
 1198 0090 00640040 		.word	1073767424
 1199              		.cfi_endproc
 1200              	.LFE9:
 1202              		.section	.text.canardSTM32GetStats,"ax",%progbits
 1203              		.align	1
 1204              		.global	canardSTM32GetStats
 1205              		.syntax unified
 1206              		.thumb
 1207              		.thumb_func
 1208              		.fpu softvfp
 1210              	canardSTM32GetStats:
 1211              	.LFB10:
 563:libcanard/drivers/stm32/canard_stm32.c **** 
 564:libcanard/drivers/stm32/canard_stm32.c **** 
 565:libcanard/drivers/stm32/canard_stm32.c **** CanardSTM32Stats canardSTM32GetStats(void)
ARM GAS  /tmp/cc0y7Ept.s 			page 33


 566:libcanard/drivers/stm32/canard_stm32.c **** {
 1212              		.loc 1 566 0
 1213              		.cfi_startproc
 1214              		@ args = 0, pretend = 0, frame = 0
 1215              		@ frame_needed = 0, uses_anonymous_args = 0
 1216              		@ link register save eliminated.
 1217              	.LVL132:
 1218 0000 10B4     		push	{r4}
 1219              	.LCFI19:
 1220              		.cfi_def_cfa_offset 4
 1221              		.cfi_offset 4, -4
 1222 0002 0446     		mov	r4, r0
 567:libcanard/drivers/stm32/canard_stm32.c ****     return g_stats;
 1223              		.loc 1 567 0
 1224 0004 034B     		ldr	r3, .L121
 1225 0006 0FCB     		ldm	r3, {r0, r1, r2, r3}
 1226              	.LVL133:
 1227 0008 84E80F00 		stm	r4, {r0, r1, r2, r3}
 568:libcanard/drivers/stm32/canard_stm32.c **** }
 1228              		.loc 1 568 0
 1229 000c 2046     		mov	r0, r4
 1230 000e 10BC     		pop	{r4}
 1231              	.LCFI20:
 1232              		.cfi_restore 4
 1233              		.cfi_def_cfa_offset 0
 1234              	.LVL134:
 1235 0010 7047     		bx	lr
 1236              	.L122:
 1237 0012 00BF     		.align	2
 1238              	.L121:
 1239 0014 00000000 		.word	.LANCHOR0
 1240              		.cfi_endproc
 1241              	.LFE10:
 1243              		.section	.bss.g_abort_tx_on_error,"aw",%nobits
 1244              		.set	.LANCHOR1,. + 0
 1247              	g_abort_tx_on_error:
 1248 0000 00       		.space	1
 1249              		.section	.bss.g_stats,"aw",%nobits
 1250              		.align	3
 1251              		.set	.LANCHOR0,. + 0
 1254              	g_stats:
 1255 0000 00000000 		.space	16
 1255      00000000 
 1255      00000000 
 1255      00000000 
 1256              		.section	.rodata.RFxR.5256,"a",%progbits
 1257              		.align	2
 1258              		.set	.LANCHOR4,. + 0
 1261              	RFxR.5256:
 1262 0000 0C640040 		.word	1073767436
 1263 0004 10640040 		.word	1073767440
 1264              		.section	.rodata.__func__.5239,"a",%progbits
 1265              		.align	2
 1266              		.set	.LANCHOR2,. + 0
 1269              	__func__.5239:
 1270 0000 63616E61 		.ascii	"canardSTM32Init\000"
 1270      72645354 
ARM GAS  /tmp/cc0y7Ept.s 			page 34


 1270      4D333249 
 1270      6E697400 
 1271              		.section	.rodata.__func__.5251,"a",%progbits
 1272              		.align	2
 1273              		.set	.LANCHOR3,. + 0
 1276              	__func__.5251:
 1277 0000 63616E61 		.ascii	"canardSTM32Transmit\000"
 1277      72645354 
 1277      4D333254 
 1277      72616E73 
 1277      6D697400 
 1278              		.section	.rodata.canardSTM32Init.str1.4,"aMS",%progbits,1
 1279              		.align	2
 1280              	.LC0:
 1281 0000 30203D3D 		.ascii	"0 == ((volatile CanardSTM32CANType*)0x40006400U)->I"
 1281      20282876 
 1281      6F6C6174 
 1281      696C6520 
 1281      43616E61 
 1282 0033 455200   		.ascii	"ER\000"
 1283 0036 0000     		.space	2
 1284              	.LC1:
 1285 0038 6C696263 		.ascii	"libcanard/drivers/stm32/canard_stm32.c\000"
 1285      616E6172 
 1285      642F6472 
 1285      69766572 
 1285      732F7374 
 1286 005f 00       		.space	1
 1287              	.LC2:
 1288 0060 28282828 		.ascii	"((((volatile CanardSTM32CANType*)0x40006400U)->FMR "
 1288      766F6C61 
 1288      74696C65 
 1288      2043616E 
 1288      61726453 
 1289 0093 3E3E2038 		.ascii	">> 8U) & 0x3FU) == 14U\000"
 1289      55292026 
 1289      20307833 
 1289      46552920 
 1289      3D3D2031 
 1290              		.section	.rodata.canardSTM32Transmit.str1.4,"aMS",%progbits,1
 1291              		.align	2
 1292              	.LC3:
 1293 0000 21224341 		.ascii	"!\"CAN PRIO INV\"\000"
 1293      4E205052 
 1293      494F2049 
 1293      4E562200 
 1294              	.LC4:
 1295 0010 74785F6D 		.ascii	"tx_mailbox < 3\000"
 1295      61696C62 
 1295      6F78203C 
 1295      203300
 1296              		.text
 1297              	.Letext0:
 1298              		.file 2 "/usr/bin/gcc-arm-none-eabi-7-2017-q4-major/arm-none-eabi/include/machine/_default_types.h
 1299              		.file 3 "/usr/bin/gcc-arm-none-eabi-7-2017-q4-major/arm-none-eabi/include/sys/_stdint.h"
 1300              		.file 4 "/usr/bin/gcc-arm-none-eabi-7-2017-q4-major/arm-none-eabi/include/stdint.h"
 1301              		.file 5 "libcanard/canard.h"
ARM GAS  /tmp/cc0y7Ept.s 			page 35


 1302              		.file 6 "/usr/bin/gcc-arm-none-eabi-7-2017-q4-major/arm-none-eabi/include/sys/lock.h"
 1303              		.file 7 "/usr/bin/gcc-arm-none-eabi-7-2017-q4-major/arm-none-eabi/include/sys/_types.h"
 1304              		.file 8 "/usr/bin/gcc-arm-none-eabi-7-2017-q4-major/lib/gcc/arm-none-eabi/7.2.1/include/stddef.h"
 1305              		.file 9 "/usr/bin/gcc-arm-none-eabi-7-2017-q4-major/arm-none-eabi/include/sys/reent.h"
 1306              		.file 10 "libcanard/drivers/stm32/canard_stm32.h"
 1307              		.file 11 "libcanard/drivers/stm32/_internal_bxcan.h"
 1308              		.file 12 "/usr/bin/gcc-arm-none-eabi-7-2017-q4-major/arm-none-eabi/include/sys/unistd.h"
 1309              		.file 13 "/usr/bin/gcc-arm-none-eabi-7-2017-q4-major/arm-none-eabi/include/assert.h"
ARM GAS  /tmp/cc0y7Ept.s 			page 36


DEFINED SYMBOLS
                            *ABS*:0000000000000000 canard_stm32.c
     /tmp/cc0y7Ept.s:16     .text.isFramePriorityHigher:0000000000000000 $t
     /tmp/cc0y7Ept.s:22     .text.isFramePriorityHigher:0000000000000000 isFramePriorityHigher
     /tmp/cc0y7Ept.s:123    .text.convertFrameIDCanardToRegister:0000000000000000 $t
     /tmp/cc0y7Ept.s:129    .text.convertFrameIDCanardToRegister:0000000000000000 convertFrameIDCanardToRegister
     /tmp/cc0y7Ept.s:164    .text.convertFrameIDRegisterToCanard:0000000000000000 $t
     /tmp/cc0y7Ept.s:170    .text.convertFrameIDRegisterToCanard:0000000000000000 convertFrameIDRegisterToCanard
     /tmp/cc0y7Ept.s:207    .text.waitMSRINAKBitStateChange:0000000000000000 $t
     /tmp/cc0y7Ept.s:213    .text.waitMSRINAKBitStateChange:0000000000000000 waitMSRINAKBitStateChange
     /tmp/cc0y7Ept.s:267    .text.processErrorStatus:0000000000000000 $t
     /tmp/cc0y7Ept.s:273    .text.processErrorStatus:0000000000000000 processErrorStatus
     /tmp/cc0y7Ept.s:330    .text.processErrorStatus:0000000000000044 $d
     /tmp/cc0y7Ept.s:338    .text.canardSTM32Init:0000000000000000 $t
     /tmp/cc0y7Ept.s:345    .text.canardSTM32Init:0000000000000000 canardSTM32Init
     /tmp/cc0y7Ept.s:636    .text.canardSTM32Init:00000000000001a8 $d
     /tmp/cc0y7Ept.s:648    .text.canardSTM32Transmit:0000000000000000 $t
     /tmp/cc0y7Ept.s:655    .text.canardSTM32Transmit:0000000000000000 canardSTM32Transmit
     /tmp/cc0y7Ept.s:877    .text.canardSTM32Transmit:00000000000000fc $d
     /tmp/cc0y7Ept.s:887    .text.canardSTM32Receive:0000000000000000 $t
     /tmp/cc0y7Ept.s:894    .text.canardSTM32Receive:0000000000000000 canardSTM32Receive
     /tmp/cc0y7Ept.s:1031   .text.canardSTM32Receive:0000000000000094 $d
     /tmp/cc0y7Ept.s:1038   .text.canardSTM32ConfigureAcceptanceFilters:0000000000000000 $t
     /tmp/cc0y7Ept.s:1045   .text.canardSTM32ConfigureAcceptanceFilters:0000000000000000 canardSTM32ConfigureAcceptanceFilters
     /tmp/cc0y7Ept.s:1198   .text.canardSTM32ConfigureAcceptanceFilters:0000000000000090 $d
     /tmp/cc0y7Ept.s:1203   .text.canardSTM32GetStats:0000000000000000 $t
     /tmp/cc0y7Ept.s:1210   .text.canardSTM32GetStats:0000000000000000 canardSTM32GetStats
     /tmp/cc0y7Ept.s:1239   .text.canardSTM32GetStats:0000000000000014 $d
     /tmp/cc0y7Ept.s:1247   .bss.g_abort_tx_on_error:0000000000000000 g_abort_tx_on_error
     /tmp/cc0y7Ept.s:1248   .bss.g_abort_tx_on_error:0000000000000000 $d
     /tmp/cc0y7Ept.s:1250   .bss.g_stats:0000000000000000 $d
     /tmp/cc0y7Ept.s:1254   .bss.g_stats:0000000000000000 g_stats
     /tmp/cc0y7Ept.s:1257   .rodata.RFxR.5256:0000000000000000 $d
     /tmp/cc0y7Ept.s:1261   .rodata.RFxR.5256:0000000000000000 RFxR.5256
     /tmp/cc0y7Ept.s:1265   .rodata.__func__.5239:0000000000000000 $d
     /tmp/cc0y7Ept.s:1269   .rodata.__func__.5239:0000000000000000 __func__.5239
     /tmp/cc0y7Ept.s:1272   .rodata.__func__.5251:0000000000000000 $d
     /tmp/cc0y7Ept.s:1276   .rodata.__func__.5251:0000000000000000 __func__.5251
     /tmp/cc0y7Ept.s:1279   .rodata.canardSTM32Init.str1.4:0000000000000000 $d
     /tmp/cc0y7Ept.s:1291   .rodata.canardSTM32Transmit.str1.4:0000000000000000 $d

UNDEFINED SYMBOLS
__assert_func
